"use strict";(self.webpackChunkAzal_FE=self.webpackChunkAzal_FE||[]).push([[0],{2e3:function(te,J,u){u.r(J),u.d(J,{UsersModule:function(){return et}});var M=u(3144),O=u(5671),f=u(4202),h=u(4825),V=u(7757),y=u.n(V),I=u(655),e=u(5e3),T=u(8279),S=u(8457),x=u(6271),d=u(3075),A=u(9489),q=u(5837),D=u(6300),F=u(3575),R=u(6253),k=u(9808),ie=u(1747),B=u(8719),L=u(3383),oe=u(7243),$=u(7756);function ae(o,s){if(1&o&&(e.TgZ(0,"nb-option",6),e._uU(1),e.qZA()),2&o){var t=s.$implicit;e.Q6J("value",t)("id",t.role_id),e.xp6(1),e.hij(" ",t.role_title," ")}}function se(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"nb-select",3),e.NdJ("selectedChange",function(a){return e.CHM(t),e.oxw().change(a)}),e.TgZ(1,"nb-option",4),e._uU(2),e.qZA(),e.YNc(3,ae,2,3,"nb-option",5),e.qZA()}if(2&o){var n=e.oxw();e.Q6J("placeholder",n.placeholder)("formControlName",n.controlName),e.xp6(1),e.Q6J("value",null),e.xp6(1),e.Oqu(n.placeholder),e.xp6(1),e.Q6J("ngForOf",n.roles)}}function re(o,s){if(1&o&&(e.TgZ(0,"form",0),e._UZ(1,"nb-select",7),e.qZA()),2&o){var t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("formControlName",t.controlName)}}var le=function(){var o=function(){function s(t){(0,O.Z)(this,s),this.http=t,this.roleChange=new e.vpe,this.gettingRoles=new e.vpe}return(0,M.Z)(s,[{key:"ngOnInit",value:function(){this.roleData?(this.roles=this.roleData,this.initRoleData()):this.getRoles()}},{key:"ngOnChanges",value:function(n){if(this.roles&&n.roleId&&n.roleId.currentValue){var i=this.roles.find(function(a){return n.roleId.currentValue===a.role_id});this.form.controls.role.setValue(i)}}},{key:"getRoles",value:function(){var n=this;this.http.get(oe.J.user.get.getAllRoles).subscribe(function(a){n.roles=a.roles,n.gettingRoles.emit(a.roles),n.initRoleData()},function(a){console.log(a)})}},{key:"initRoleData",value:function(){var n=this;1===this.roles.length&&this.form.controls.role.setValue(this.roles[0]),2==this.roleId&&this.roles.push({role_id:2,role_title:"Account Owner",is_mobile:!0,is_web:!0});var a=this.roles.find(function(r){return n.roleId===r.role_id});this.form.controls.role.setValue(a),this.roleChange.emit(a)}},{key:"change",value:function(n){this.roleChange.emit(n)}}]),s}();return o.\u0275fac=function(t){return new(t||o)(e.Y36($.s))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-roles-dropdown"]],inputs:{form:"form",controlName:"controlName",placeholder:"placeholder",roleId:"roleId",roleData:"roleData"},outputs:{roleChange:"roleChange",gettingRoles:"gettingRoles"},features:[e.TTD],decls:4,vars:3,consts:[[3,"formGroup"],[3,"placeholder","formControlName","selectedChange",4,"ngIf","ngIfElse"],["emptydrop",""],[3,"placeholder","formControlName","selectedChange"],[3,"value"],[3,"value","id",4,"ngFor","ngForOf"],[3,"value","id"],["disabled","","placeholder","No item to select",3,"formControlName"]],template:function(t,n){if(1&t&&(e.TgZ(0,"form",0),e.YNc(1,se,4,5,"nb-select",1),e.qZA(),e.YNc(2,re,2,2,"ng-template",null,2,e.W1O)),2&t){var i=e.MAs(3);e.Q6J("formGroup",n.form),e.xp6(1),e.Q6J("ngIf",(null==n.roles?null:n.roles.length)>0)("ngIfElse",i)}},directives:[d._Y,d.JL,d.sg,A.w5,k.O5,h.rs,d.JJ,d.u,A.x0,A.bf,h.q51,k.sg],styles:[""]}),o}(),pe=u(5718),de=u(2125),Q=u(42),j=u(82),ce=["ngForm"];function ue(o,s){1&o&&(e.TgZ(0,"label"),e.TgZ(1,"b",33),e._uU(2,"New User"),e.qZA(),e.qZA())}function me(o,s){if(1&o&&(e.TgZ(0,"span"),e.TgZ(1,"span",34),e._uU(2),e.qZA(),e._UZ(3,"br"),e.TgZ(4,"span",35),e._uU(5),e.qZA(),e._UZ(6,"br"),e.qZA()),2&o){var t=e.oxw();e.xp6(2),e.hij(" ",t.userDetails.name," "),e.xp6(3),e.hij(" ",t.userDetails.role_title," ")}}function ge(o,s){if(1&o&&(e.TgZ(0,"li"),e.TgZ(1,"b"),e._uU(2),e.qZA(),e._uU(3),e.qZA()),2&o){var t=s.$implicit;e.xp6(2),e.hij(" ",t.role_title,":"),e.xp6(1),e.hij(" ",t.role_description," ")}}function _e(o,s){if(1&o&&(e.ynx(0),e.YNc(1,ge,4,2,"li",39),e.BQk()),2&o){var t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.roles)}}function he(o,s){if(1&o&&(e.TgZ(0,"span"),e.TgZ(1,"span",36),e.TgZ(2,"p"),e._uU(3," Users with access to mobile application, will use a 4-digits PIN to login. If the PIN is not manually set, then a random PIN will be sent via text message to the user. "),e.qZA(),e.qZA(),e.TgZ(4,"span",37),e.TgZ(5,"b"),e._uU(6,"Roles: Permissions"),e.qZA(),e.qZA(),e.TgZ(7,"ul",38),e.YNc(8,_e,2,1,"ng-container",2),e.qZA(),e.qZA()),2&o){var t=e.oxw();e.xp6(8),e.Q6J("ngIf",t.roles)}}function fe(o,s){1&o&&(e.TgZ(0,"div",40),e._UZ(1,"i",41),e._uU(2,"Remove user from a store by clicking on the cross icon."),e.qZA())}function ve(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"span",42),e.TgZ(1,"nb-checkbox",43),e.NdJ("checkedChange",function(a){return e.CHM(t),e.oxw().checkedChange(a)}),e._uU(2,"Or assign user to all current and future stores "),e.qZA(),e.qZA()}if(2&o){var n=e.oxw();e.xp6(1),e.Q6J("checked",n.isAllChecked)}}function Ce(o,s){if(1&o&&(e.TgZ(0,"div",46),e.TgZ(1,"div",65),e._UZ(2,"i",66),e.TgZ(3,"span",12),e._uU(4," *"),e.qZA(),e.qZA(),e.TgZ(5,"div",49),e._UZ(6,"app-text-input",54),e._UZ(7,"app-error-message",55),e.qZA(),e._UZ(8,"div",20),e.qZA()),2&o){var t=e.oxw().$implicit;e.oxw();var n=e.MAs(9);e.xp6(6),e.Q6J("autofocus",!0)("placeholder","Enter company name")("controlName","companyName")("form",t),e.xp6(1),e.Q6J("key","companyName")("form",t)("isSubmitted",n.submitted)}}function be(o,s){1&o&&(e.TgZ(0,"span",12),e._uU(1," *"),e.qZA())}function Te(o,s){if(1&o&&(e.TgZ(0,"div",46),e.TgZ(1,"div",67),e._UZ(2,"i",68),e.YNc(3,be,2,0,"span",69),e.qZA(),e.TgZ(4,"div",49),e._UZ(5,"app-text-input",70),e._UZ(6,"app-error-message",51),e.qZA(),e._UZ(7,"div",20),e.qZA()),2&o){var t=e.oxw(),n=t.index,i=t.$implicit,a=e.oxw(),r=e.MAs(9);e.xp6(3),e.Q6J("ngIf",a.azalioPinRequired[n]),e.xp6(2),e.Q6J("type","text")("controlName","azalioPin")("maxlength",a.azalioPinLength)("placeholder",a.userDetails?"Update custom pin for azalio play":"Enter a unique pin for azalio play")("form",i),e.xp6(1),e.Q6J("key","azalioPin")("form",i)("isSubmitted",r.submitted)}}function we(o,s){1&o&&(e.TgZ(0,"span",71),e._uU(1," *"),e.qZA())}function xe(o,s){1&o&&(e.TgZ(0,"span",81),e._uU(1," *"),e.qZA())}function Ze(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"span",82),e.TgZ(1,"span",83),e.TgZ(2,"span",84),e.TgZ(3,"nb-checkbox",85),e.NdJ("checkedChange",function(p){return e.CHM(t),e.oxw(3).setSMSCheckbox(p)}),e._uU(4),e.qZA(),e.qZA(),e.qZA(),e.TgZ(5,"span",86),e._UZ(6,"app-error-message",19),e.qZA(),e.qZA()}if(2&o){var n=e.oxw(2).$implicit,i=e.oxw(),a=e.MAs(9);e.xp6(3),e.Q6J("checked",null==n.controls||null==n.controls.sendSMS?null:n.controls.sendSMS.value),e.xp6(1),e.hij(" ",i.userDetails?"Send SMS on pin change":"Send SMS with app link"," "),e.xp6(2),e.Q6J("key","phone")("form",n)("isSubmitted",a.submitted)}}var E=function(s){return{"mb-22":s}};function ye(o,s){if(1&o){var t=e.EpF();e.ynx(0),e.TgZ(1,"div",87),e._UZ(2,"img",88),e.qZA(),e.TgZ(3,"div",89),e.TgZ(4,"app-text-input",90),e.NdJ("focusin",function(){e.CHM(t);var p=e.oxw(2).$implicit;return e.oxw().onPinFocus(p)})("focusout",function(){e.CHM(t);var p=e.oxw(2).$implicit;return e.oxw().onPinFocusOut(p)}),e.qZA(),e._UZ(5,"app-error-message",91),e.qZA(),e.TgZ(6,"div",92),e.TgZ(7,"img",93),e.NdJ("mouseenter",function(){return e.CHM(t),e.oxw(3).phoneAnalytics()}),e.qZA(),e.qZA(),e.BQk()}if(2&o){var n=e.oxw(2).$implicit,i=e.oxw(),a=e.MAs(9);e.xp6(1),e.Q6J("ngClass",e.VKq(11,E,i.showSMSCheckbox)),e.xp6(2),e.Q6J("ngClass",e.VKq(13,E,i.showSMSCheckbox)),e.xp6(1),e.Q6J("type",i.pinInputType)("controlName","pin")("maxlength",4)("placeholder",i.userDetails?"Update pin for mobile app":"Enter pin for mobile app")("form",n),e.xp6(1),e.Q6J("key","pin")("form",n)("isSubmitted",a.submitted),e.xp6(1),e.Q6J("ngClass",e.VKq(15,E,i.showSMSCheckbox))}}var Ae=function(s){return{pin_hidden:s}};function Ue(o,s){if(1&o&&(e.TgZ(0,"div",72),e.TgZ(1,"div",73),e._UZ(2,"i",74),e.YNc(3,xe,2,0,"span",75),e.qZA(),e.TgZ(4,"div",76),e.TgZ(5,"span",77),e._UZ(6,"app-country-code-dropdown",78),e._UZ(7,"app-error-message",19),e._UZ(8,"app-text-input",79),e.qZA(),e.YNc(9,Ze,7,5,"span",80),e.qZA(),e.YNc(10,ye,8,17,"ng-container",2),e.qZA()),2&o){var t=e.oxw(),n=t.index,i=t.$implicit,a=e.oxw(),r=e.MAs(9);e.xp6(1),e.Q6J("ngClass",e.VKq(13,E,a.showSMSCheckbox)),e.xp6(2),e.Q6J("ngIf",a.phoneRequired[n]),e.xp6(1),e.Q6J("ngClass",e.VKq(15,Ae,i.controls.pin.disabled)),e.xp6(2),e.Q6J("controlName","countrycode")("form",i),e.xp6(1),e.Q6J("key","countrycode")("form",i)("isSubmitted",r.submitted),e.xp6(1),e.Q6J("controlName","phone")("placeholder",i.controls.pin.disabled?"Phone number":"Enter phone number to log into mobile app")("form",i),e.xp6(1),e.Q6J("ngIf",a.showSMSCheckbox),e.xp6(1),e.Q6J("ngIf",!1===i.controls.pin.disabled)}}function ke(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"div",44),e.YNc(1,Ce,9,7,"div",45),e.TgZ(2,"div",46),e.TgZ(3,"div",47),e._UZ(4,"i",48),e.TgZ(5,"span",12),e._uU(6," *"),e.qZA(),e.qZA(),e.TgZ(7,"div",49),e.TgZ(8,"app-roles-dropdown",50),e.NdJ("roleChange",function(l){var _=e.CHM(t).index;return e.oxw().updateValidations(l,_)})("gettingRoles",function(l){return e.CHM(t),e.oxw().setRoles(l)}),e.qZA(),e._UZ(9,"app-error-message",51),e.qZA(),e._UZ(10,"div",20),e.qZA(),e.YNc(11,Te,8,9,"div",45),e.TgZ(12,"div",46),e.TgZ(13,"div",52),e._UZ(14,"i",53),e.TgZ(15,"span",12),e._uU(16," *"),e.qZA(),e.qZA(),e.TgZ(17,"div",49),e._UZ(18,"app-text-input",54),e._UZ(19,"app-error-message",55),e.qZA(),e._UZ(20,"div",20),e.qZA(),e.TgZ(21,"div",56),e.TgZ(22,"div",57),e._UZ(23,"i",58),e.YNc(24,we,2,0,"span",59),e.qZA(),e.TgZ(25,"div",60),e._UZ(26,"app-text-input",61),e._UZ(27,"app-error-message",19),e.qZA(),e._UZ(28,"div",20),e.qZA(),e.YNc(29,Ue,11,17,"div",62),e.TgZ(30,"div",46),e.TgZ(31,"div",63),e._UZ(32,"i",53),e.qZA(),e.TgZ(33,"div",49),e._UZ(34,"app-text-input",64),e._UZ(35,"app-error-message",55),e.qZA(),e._UZ(36,"div",20),e.qZA(),e.qZA()}if(2&o){var n=s.$implicit,i=s.index,a=e.oxw(),r=e.MAs(9);e.xp6(1),e.Q6J("ngIf",a.isEditingAccountOwner&&a.isAccountOwner),e.xp6(7),e.Q6J("roleData",a.roles)("placeholder","Select role")("controlName","role")("form",n)("roleId",a.roleId),e.xp6(1),e.Q6J("key","role")("form",n)("isSubmitted",r.submitted),e.xp6(2),e.Q6J("ngIf",a.isAzalioPlay&&a.isCustomAzalioPin&&a.azalioPinRequired[i]),e.xp6(7),e.Q6J("autofocus",!0)("placeholder","Enter name")("controlName","fullName")("form",n),e.xp6(1),e.Q6J("key","fullName")("form",n)("isSubmitted",r.submitted),e.xp6(5),e.Q6J("ngIf",a.emailRequired[i]),e.xp6(2),e.Q6J("placeholder","Enter email to log into web app")("controlName","email")("form",n),e.xp6(1),e.Q6J("key","email")("form",n)("isSubmitted",r.submitted),e.xp6(2),e.Q6J("ngIf",!a.rolesLoading),e.xp6(5),e.Q6J("autofocus",!0)("placeholder","Enter employee ID (optional)")("controlName","externalId")("form",n),e.xp6(1),e.Q6J("key","externalId")("form",n)("isSubmitted",r.submitted)}}function Me(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"div",94),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.TgZ(3,"span",95),e.NdJ("click",function(){return e.CHM(t),e.oxw().openNestedSideBar()}),e._UZ(4,"nb-icon",96),e.TgZ(5,"span",97),e._uU(6," Assign New "),e.qZA(),e.qZA(),e.qZA()}if(2&o){var n=e.oxw();e.xp6(2),e.AsE(" Assigned ",null==n.nameConfig?null:n.nameConfig.region_plural," & ",null==n.nameConfig?null:n.nameConfig.team_plural,"")}}function Oe(o,s){1&o&&(e.TgZ(0,"span",98),e._UZ(1,"img",99),e.TgZ(2,"span"),e._uU(3,"You need account owner access to remove this user. Please contact your administrator. "),e.qZA(),e.qZA())}var Pe=function(s){return{hide:s}};function Ie(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"app-confirm-popup",100),e.NdJ("proceedDelete",function(){return e.CHM(t),e.oxw().deleteUser(null)}),e.TgZ(1,"span",101),e._UZ(2,"i",102),e.TgZ(3,"span"),e._uU(4,"Delete User"),e.qZA(),e.qZA(),e.qZA()}if(2&o){var n=e.oxw();e.Q6J("title","User")("textToDisplay","You're about to <b>permanently delete</b> this user. Once deleted, the user will not be able to use Azalio. Are you sure?"),e.xp6(1),e.Q6J("ngClass",e.VKq(3,Pe,n.userDetails.is_account_owner))}}function Se(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"app-confirm-popup",103),e.NdJ("proceedDelete",function(){return e.CHM(t),e.oxw().deleteUserFromStore()}),e.TgZ(1,"span",104),e._UZ(2,"i",102),e.TgZ(3,"span"),e._uU(4,"Remove User"),e.qZA(),e.qZA(),e.qZA()}if(2&o){var n=e.oxw();e.Q6J("title","User")("type","Remove")("textToDisplay","You're about to <b>permanently remove</b> this user from "+n.commonStoreCount+" store(s). \n            Once removed, the user will not be able to access these store(s). Are you sure?")}}function qe(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"span",105),e.TgZ(1,"nb-checkbox",106),e.NdJ("checkedChange",function(a){return e.CHM(t),e.oxw().updateCreateAnother(a)}),e.qZA(),e._uU(2," Add another user "),e.qZA()}if(2&o){var n=e.oxw();e.xp6(1),e.Q6J("checked",n.isCreateAnother)}}var Ne=function(s){return{mb_30:s}},Y=function(){var o=function(){function s(t,n,i,a,r,p){var l=this;(0,O.Z)(this,s),this.ref=t,this.dataService=n,this.gs=i,this.fb=a,this.service=r,this.analytics=p,this.nestedClick=new e.vpe,this.formSuccess=new e.vpe,this.phoneRequired=new Array,this.emailRequired=new Array,this.azalioPinRequired=new Array,this.regionData=null,this.userRegionData=null,this.showDelete=!1,this.buttonLabel="Add",this.isCreateAnother=!1,this.isPartner=0,this.AddUserFormValues=function(){l.AddUserForm=l.fb.group({regionTeams:["",d.kI.required],usersArray:new d.Oe([])});var m=l.dataService.getSelectedFilter();l.defaultAssignment=l.regionId?l.regionId:m?[m]:l.regionId,l.AddUserForm.controls.regionTeams.setValue(l.defaultAssignment)},this.updateValidations=function(m,_){if(m){l.phoneRequired[_]=m.is_mobile,l.emailRequired[_]=m.is_web,l.azalioPinRequired[_]=l.isAzalioPlay&&l.isCustomAzalioPin&&m.is_azalio_play;var c=l.users.controls[_];c.controls.sendSMS&&(c.controls.sendSMS.setValue(m.sms_check_default_value),c.controls.sendSMS.updateValueAndValidity(),l.showSMSCheckbox=l.isSMSCheckbox&&m.is_mobile),l.phoneRequired[_]?(c.controls.phone.setValidators([d.kI.required,A.CM.unique(),d.kI.pattern(/^\d{7,10}$/)]),c.controls.phone.updateValueAndValidity(),c.controls.countrycode.setValidators([d.kI.required]),c.controls.countrycode.updateValueAndValidity(),c.controls.pin.setValue(l.userDetails?"****":1234),c.controls.pin.enable()):l.phoneRequired[_]||(c.controls.phone.setValidators([A.CM.unique(),d.kI.pattern(/^\d{7,10}$/)]),c.controls.phone.updateValueAndValidity(),c.controls.countrycode.setValidators([]),c.controls.countrycode.updateValueAndValidity(),c.controls.pin.setValue("****"),c.controls.pin.disable()),l.emailRequired[_]?(c.controls.email.setValidators([d.kI.required,d.kI.pattern(x.HN),d.kI.maxLength(100),A.CM.unique()]),c.controls.email.updateValueAndValidity()):l.emailRequired[_]||(c.controls.email.setValidators([d.kI.pattern(x.HN),d.kI.maxLength(100),A.CM.unique()]),c.controls.email.updateValueAndValidity()),l.azalioPinRequired[_]?(c.controls.azalioPin.setValidators([d.kI.required,d.kI.pattern(l.pinPattern)]),c.controls.azalioPin.updateValueAndValidity()):l.azalioPinRequired[_]||(c.controls.azalioPin.setValidators([]),c.controls.azalioPin.updateValueAndValidity())}},this.submit=function(m){l.updateValidators("regionTeams",l.isAllChecked?[]:[d.kI.required]),console.log(m),m.valid&&(l.loading=!0,l.isAllChecked&&l.AddUserForm.controls.regionTeams.setValue([{id:null,name:"All Stores",type:"Region",is_partner:!0}]),l.userDetails?l.editUser(m):l.addUser(m))},this.addUser=function(m){return(0,I.mG)(l,void 0,void 0,y().mark(function _(){var v,C,g,c=this;return y().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return v=this.users.controls.map(function(U){return c.roleId=U.get("role").value.role_id,{name:U.get("fullName").value,email:U.get("email").value,phone:U.get("phone").value?U.get("countrycode").value.code+U.get("phone").value:"",role_id:U.get("role").value.role_id,pin:U.get("pin").value,play_pin:U.get("azalioPin").value,external_id:U.get("externalId").value,send_sms:!!c.showSMSCheckbox&&U.get("sendSMS").value}}),C={users:v,assignments:this.AddUserForm.get("regionTeams").value},b.prev=2,b.next=5,this.service.addUsers(C);case 5:if(this.gs.showToastSuccess(null==(g=b.sent)?void 0:g.message),!this.isCreateAnother){b.next=10;break}return this.close({refresh:!1,createAnother:!0,roleId:this.roleId,regionId:this.regionId}),b.abrupt("return");case 10:this.close({refresh:!0,createAnother:!1,roleId:null,regionId:null}),b.next=16;break;case 13:b.prev=13,b.t0=b.catch(2),this.gs.showToastError(b.t0.message);case 16:return b.prev=16,this.loading=!1,b.finish(16);case 19:case"end":return b.stop()}},_,this,[[2,13,16,19]])}))},this.editUser=function(m){return(0,I.mG)(l,void 0,void 0,y().mark(function _(){var v,C,g,P,b,U,c=this;return y().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(P=(null===(v=this.userDetails)||void 0===v?void 0:v.is_account_owner)?this.users.controls.map(function(w){var z={id:w.get("id").value,name:w.get("fullName").value,email:w.get("email").value,company_name:w.get("companyName").value,phone:w.get("phone").value?w.get("countrycode").value.code+w.get("phone").value:"",external_id:w.get("externalId").value,send_sms:!!c.showSMSCheckbox&&w.get("sendSMS").value};return c.insertPin(w,z)}):this.users.controls.map(function(w){c.roleTitle=w.get("role").value.role_title;var z={id:w.get("id").value,name:w.get("fullName").value,email:w.get("email").value,phone:w.get("phone").value?w.get("countrycode").value.code+w.get("phone").value:"",role_id:w.get("role").value.role_id,external_id:w.get("externalId").value,send_sms:!!c.showSMSCheckbox&&w.get("sendSMS").value};return c.insertPin(w,z)}),b=(null===(C=this.userDetails)||void 0===C?void 0:C.is_account_owner)?{users:P}:{users:P,assignments:this.AddUserForm.get("regionTeams").value},Z.prev=2,null===(g=this.userDetails)||void 0===g?void 0:g.is_account_owner){Z.next=9;break}return Z.next=6,this.service.editUser(b);case 6:Z.t0=Z.sent,Z.next=12;break;case 9:return Z.next=11,this.service.editAccountOwner(b);case 11:Z.t0=Z.sent;case 12:this.gs.showToastSuccess(null==(U=Z.t0)?void 0:U.message),this.updateUserInfoInHeader(b),this.close({refresh:!0,createAnother:!1,roleId:null,regionId:null}),Z.next=21;break;case 18:Z.prev=18,Z.t1=Z.catch(2),this.gs.showToastError(Z.t1.message);case 21:return Z.prev=21,this.loading=!1,Z.finish(21);case 24:case"end":return Z.stop()}},_,this,[[2,18,21,24]])}))},this.deleteUser=function(m){return(0,I.mG)(l,void 0,void 0,y().mark(function _(){var c,v;return y().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c={user_id:this.user_id,store_id:m},g.prev=1,this.loading=!0,g.next=5,this.service.deleteUsers(c);case 5:this.gs.showToastSuccess(null==(v=g.sent)?void 0:v.message),this.close({refresh:!0,createAnother:!1,roleId:null,regionId:null}),g.next=13;break;case 10:g.prev=10,g.t0=g.catch(1),this.gs.showToastError(g.t0.message);case 13:return g.prev=13,this.loading=!1,g.finish(13);case 16:case"end":return g.stop()}},_,this,[[1,10,13,16]])}))},this.dataService.getConfigurations(!1).then(function(m){var _,c,v,C,g,P,b;l.isCustomAzalioPin=0==(null===(_=m.company)||void 0===_?void 0:_.azalio_pin_auto_generate),l.azalioPinLength=null===(c=m.company)||void 0===c?void 0:c.azalio_pin_length,l.isAzalioPlay=1==(null===(v=m.company)||void 0===v?void 0:v.is_azalio_play),l.nameConfig=null===(C=m.company)||void 0===C?void 0:C.custom_names,l.isTeam=1===(null===(g=m.company)||void 0===g?void 0:g.is_team),l.isPartner=m.is_partner,l.isSMSCheckbox=1===(null===(P=m.company)||void 0===P?void 0:P.is_sms_checkbox),(2===m.role.role_id||m.role.role_title.includes("Account Owner"))&&(l.isAccountOwner=!0),l.placeholder="Search and assign "+(null===(b=l.nameConfig)||void 0===b?void 0:b.region.toLowerCase())}).finally(function(){switch(l.azalioPinLength){case 3:return void(l.pinPattern=new RegExp(/^\d{3,3}$/));case 4:return void(l.pinPattern=new RegExp(/^\d{4,4}$/));case 5:l.pinPattern=new RegExp(/^\d{5,5}$/);default:return""}})}return(0,M.Z)(s,[{key:"ngOnInit",value:function(){var i,a,r,p,l,n=this;if(this.commonStoreCount=0,this.defaultAssignment=[],this.isAllChecked=!1,this.pinInputType="text",this.opacity=x.ZF,this.AddUserFormValues(),this.onAddUser("adduser"),this.isCreateAnother=this.openAddView,this.isEditingAccountOwner=!!(null===(i=this.userDetails)||void 0===i?void 0:i.is_account_owner),this.userDetails){this.setCommonCount();var _,c,m=null===(a=this.userDetails.assignments)||void 0===a?void 0:a.findIndex(function(C){return null===C.id});this.isAllChecked=m>-1,this.rolesLoading=!0,this.roleId=this.userDetails.role_id,this.pinInputType="password",0==this.userDetails.assignments.length&&0!==this.userDetails.regions.length&&(this.userDetails.assignments=this.userDetails.regions.map(function(C){return{id:C.region_id,name:C.region_title,type:"Region",color:n.userDetails.user_color}})),this.showDelete=!0,this.userDetails.phone_number&&(null===(r=this.userDetails.phone_number)||void 0===r?void 0:r.includes("-"))&&(c={code:(_=this.userDetails.phone_number.split("-"))[0]}),this.users.clear(),this.users.push(this.fb.group({id:[this.userDetails.id],fullName:[this.userDetails.name,[d.kI.required,d.kI.maxLength(100)]],email:[this.userDetails.email,d.kI.maxLength(100)],phone:[_?_[1]:"",[d.kI.minLength(7),d.kI.maxLength(10)]],role:[this.userDetails.role_id,d.kI.required],companyName:[""],azalioPin:[this.isCustomAzalioPin?this.userDetails.play_pin:null],pin:["****",s.isValidPin],countrycode:[c||""],externalId:[this.userDetails.external_id,[d.kI.maxLength(145),d.kI.pattern(/^[a-zA-Z0-9\.]*$/)]],sendSMS:[]})),this.userDetails.is_account_owner&&setTimeout(function(){var C=n.users.controls[0];C.controls.role.disable(),C.controls.companyName.setValue(n.dataService.getCompanyName()),C.controls.companyName.setValidators([d.kI.required,d.kI.maxLength(100)]),C.controls.companyName.updateValueAndValidity(),n.isAccountOwner||(C.controls.fullName.disable(),C.controls.email.disable())}),(null===(p=null==this?void 0:this.userDetails)||void 0===p?void 0:p.is_account_owner)&&(this.userDetails.assignments=[{name:"All "+(null===(l=this.nameConfig)||void 0===l?void 0:l.region_plural)}]),this.AddUserForm.controls.regionTeams.setValue(null===this.userDetails.assignments?[]:this.userDetails.assignments),this.user_id=this.userDetails.id,this.buttonLabel="Update"}}},{key:"onTagSelectionChange",value:function(n){var i=(null==n?void 0:n.size)>0?Array.from(n):"";this.regionId=i,this.AddUserForm.controls.regionTeams.setValue(i)}},{key:"checkedChange",value:function(n){this.isAllChecked=n,n&&this.gs.logEvents("assign_user_to_all_stores"),this.updateValidators("regionTeams",n?[]:[d.kI.required])}},{key:"setRoles",value:function(n){this.rolesLoading=!1,this.roles=n}},{key:"updateValidators",value:function(n,i){this.AddUserForm.controls[n].setValidators(i),this.AddUserForm.controls.regionTeams.updateValueAndValidity()}},{key:"setSMSCheckbox",value:function(n){var i=this.users.controls[0];i.controls.sendSMS.setValue(n),i.controls.sendSMS.updateValueAndValidity()}},{key:"insertPin",value:function(n,i){var a=n.get("pin").value;null!==a&&""!==a&&"****"!==a&&Object.assign(i,{pin:n.get("pin").value});var r=n.get("azalioPin").value;return this.isAzalioPlay&&this.isCustomAzalioPin&&null!==r&&""!==r&&"****"!==r&&Object.assign(i,{play_pin:n.get("azalioPin").value}),i}},{key:"updateUserInfoInHeader",value:function(n){this.userDetails.is_account_owner&&n.users[0].company_name&&this.dataService.setCompanyName(n.users[0].company_name),this.dataService.getLoggedInUserId()===this.userDetails.id&&(this.dataService.setUserName(n.users[0].name),this.dataService.setLoggedInUserEmail(n.users[0].email),this.dataService.setLoggedInUserRole(this.roleTitle))}},{key:"deleteUserFromStore",value:function(){var n;(null===(n=this.editableStoreIds)||void 0===n?void 0:n.length)>0&&this.deleteUser(this.editableStoreIds)}},{key:"openNestedSideBar",value:function(){this.nestedClick.emit(this.userRegionData)}},{key:"onSubmitClick",value:function(n){document.getElementById("submit-add-user").click()}},{key:"onAddUser",value:function(n){var i=this;"anotheruser"===n&&this.analytics.logEvents("add_another_user"),this.users.push(this.fb.group({id:[null],fullName:["",[d.kI.required,d.kI.maxLength(100)]],email:["",[d.kI.pattern(x.HN),d.kI.maxLength(100),A.CM.unique()]],phone:["",[A.CM.unique(),d.kI.pattern(/^\d{7,10}$/)]],role:["",d.kI.required],pin:["",[d.kI.pattern(/^\d{4,4}$/)]],azalioPin:["",[d.kI.pattern(this.pinPattern)]],countrycode:[],externalId:["",[d.kI.pattern(/^[a-zA-Z0-9\.]*$/),d.kI.maxLength(145)]],sendSMS:[!1]})),this.phoneRequired.push(!1),this.emailRequired.push(!1),setTimeout(function(){var a=i.users.controls[i.users.length-1];a.controls.pin.setValue("****"),a.controls.pin.disable(),i.updateValidations(a.controls.role.value,i.users.length-1)},10)}},{key:"onRemoveUser",value:function(n){this.phoneRequired.splice(n,1),this.emailRequired.splice(n,1),this.users.removeAt(n)}},{key:"form",get:function(){return this.AddUserForm.controls}},{key:"users",get:function(){return this.form.usersArray}},{key:"close",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{refresh:!1,createAnother:!1,roleId:null,regionId:null};this.ref.close(n)}},{key:"levelAnalytics",value:function(){this.analytics.logEvents("level_tooltip")}},{key:"phoneAnalytics",value:function(){this.analytics.logEvents("phone_pin_tooltip")}},{key:"updateCreateAnother",value:function(n){this.isCreateAnother=n}},{key:"onPinFocus",value:function(n){this.userDetails&&"****"===n.controls.pin.value&&(this.pinInputType="text",n.controls.pin.setValue(" "),setTimeout(function(){n.controls.pin.setValue("")}))}},{key:"onPinFocusOut",value:function(n){this.userDetails&&""===n.controls.pin.value&&(n.controls.pin.setValue("****"),this.pinInputType="password")}},{key:"isShowCheckbox",value:function(){return(this.isAccountOwner||this.isPartner)&&!this.isEditingAccountOwner}},{key:"isSelf",value:function(){return this.userDetails.id===this.dataService.getLoggedInUserId()}},{key:"isShowDelete",value:function(){var n;if(!0===this.showDelete&&!this.isSelf())return!(null===(n=this.userDetails)||void 0===n?void 0:n.is_account_owner)&&(this.isAccountOwner||this.isPartner)}},{key:"isShowRemove",value:function(){var n,i;if(!0===this.showDelete&&!this.isSelf())return!((null===(n=this.userDetails)||void 0===n?void 0:n.is_account_owner)||(null===(i=this.userDetails)||void 0===i?void 0:i.is_partner)||this.isAccountOwner||this.isPartner)}},{key:"isShowDisclaimer",value:function(){var n;if(!0===this.showDelete)return(null===(n=this.userDetails)||void 0===n?void 0:n.is_partner)&&!this.isAccountOwner&&!this.isPartner}},{key:"setCommonCount",value:function(){if(this.isAccountOwner||this.isPartner)this.disableStoreIds=[],this.editableStoreIds=null;else{var n=this.dataService.getLoggedInUserStores(),i=this.userDetails.assignments.filter(function(r){return!n.some(function(p){return r.id===p.region_id})}),a=this.userDetails.assignments.filter(function(r){return n.some(function(p){return r.id===p.region_id})});this.disableStoreIds=i.map(function(r){return r.id}),this.editableStoreIds=a.map(function(r){return r.id}),this.commonStoreCount=a.length}}}],[{key:"isValidPin",value:function(n){return!n.value||"****"===n.value||String(n.value).match(/^\d{4,4}$/)?null:{isValidPin:!0}}}]),s}();return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.X4l),e.Y36(q.s),e.Y36(D.m),e.Y36(d.qu),e.Y36(F.K),e.Y36(R.C))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-user"]],viewQuery:function(t,n){var i;1&t&&e.Gf(ce,5),2&t&&e.iGM(i=e.CRH())&&(n.ngForm=i.first)},inputs:{userDetails:"userDetails",openAddView:"openAddView",regionId:"regionId",roleId:"roleId",resetAddUserFormToggle:"resetAddUserFormToggle"},outputs:{nestedClick:"nestedClick",formSuccess:"formSuccess"},features:[e._Bn([h.Gln])],decls:39,vars:24,consts:[[1,"modal_wrapper","add_user_modal"],[1,"card_header",2,"position","relative"],[4,"ngIf"],[1,"search-user-resp",3,"nbSpinner"],["style","padding-top: 20px"],["templateId",""],["id","form","autocomplete","off",1,"form_parent",3,"formGroup","ngSubmit"],["ngForm","ngForm"],["class","unassign-store",4,"ngIf"],[1,"flex","space_between","vertical_center","Personal_details","relative",2,"padding","1rem 1.5rem","padding-bottom","0px",3,"ngClass"],["nbTooltipPlacement","top","nbTooltip","Store",2,"width","6%","padding-right","8px","display","flex"],[1,"fas","fa-store","icon-color"],[1,"mandatory"],[1,"name_resp",2,"width","100%","position","relative"],[3,"disableTags","disabled","data","placeholder","changeClick"],[2,"position","absolute","width","100%","margin-top","4px"],[1,"sub-row"],["class","assign-store-checkbox",4,"ngIf"],[1,"error-msg"],[3,"key","form","isSubmitted"],[2,"width","5%","padding-right","5px"],[1,"modal_body_wrapper"],["class","wrappper",4,"ngFor","ngForOf"],["class","assign_regionTeams_section pointer flex space_between",4,"ngIf"],[1,"flex","modal-footer"],["class","flex",4,"ngIf"],[3,"title","textToDisplay","proceedDelete",4,"ngIf"],[3,"title","type","textToDisplay","proceedDelete",4,"ngIf"],["class","create-another",4,"ngIf"],[1,"footer-add-user"],[3,"onClick"],[3,"form","label"],[1,"footer_button",2,"display","none"],[1,"title",2,"position","relative","top","4px"],[1,"title",2,"font-size","18px","font-weight","400","margin-top","5px"],[1,"role-title"],[1,"para_txt_resp"],[2,"font-size","1.05rem","margin-left","6px"],[1,"popup_ui"],[4,"ngFor","ngForOf"],[1,"unassign-store"],[1,"fa","fa-exclamation-triangle",2,"margin-right","10px"],[1,"assign-store-checkbox"],[2,"position","relative","top","5px",3,"checked","checkedChange"],[1,"wrappper"],["class","flex space_between vertical_center Personal_details mb_30 relative",4,"ngIf"],[1,"flex","space_between","vertical_center","Personal_details","mb_30","relative"],["nbTooltipPlacement","top","nbTooltip","Role",1,"role_resp",2,"width","6%","padding-right","5px","display","flex"],[1,"fa","fa-briefcase","icon-color"],[1,"name_resp",2,"width","100%"],[3,"roleData","placeholder","controlName","form","roleId","roleChange","gettingRoles"],[2,"position","absolute","width","100%",3,"key","form","isSubmitted"],["nbTooltipPlacement","top","nbTooltip","Name",2,"width","6%","padding-right","5px","display","flex"],[1,"fa","fa-user","icon-color"],[3,"autofocus","placeholder","controlName","form"],[1,"name_input_resp",2,"position","absolute","width","100%",3,"key","form","isSubmitted"],[1,"flex","space_between","vertical_center","Personal_details","relative",2,"margin-bottom","25px"],["nbTooltipPlacement","top","nbTooltip","Email",2,"width","6%","padding-right","5px","display","flex"],[1,"fa","fa-envelope","icon-color"],["span","","class","mandatory",4,"ngIf"],[1,"name_resp",2,"width","95%"],[1,"email_input_resp",3,"placeholder","controlName","form"],["class","flex space_between vertical_center Personal_details relative","style","display: inline-flex;margin-bottom: 25px;",4,"ngIf"],["nbTooltipPlacement","top","nbTooltip","Employee ID",2,"width","6%","padding-right","5px","display","flex"],["maxlength","145",3,"autofocus","placeholder","controlName","form"],["nbTooltipPlacement","top","nbTooltip","Company",2,"width","6%","padding-right","5px","display","flex"],[1,"fa","fa-building","icon-color"],["nbTooltipPlacement","top","nbTooltip","Azalio play pin",1,"role_resp",2,"width","6%","padding-right","5px","display","flex"],[1,"fa","fa-lock","icon-color"],["class","mandatory",4,"ngIf"],["autocomplete","off",3,"type","controlName","maxlength","placeholder","form"],["span","",1,"mandatory"],[1,"flex","space_between","vertical_center","Personal_details","relative",2,"display","inline-flex","margin-bottom","25px"],["nbTooltipPlacement","top","nbTooltip","Phone number",2,"width","6%","padding-right","5px","display","flex",3,"ngClass"],[1,"fa","fa-phone","icon-color","phone"],["class","mandatory","style","position: absolute;margin-left: 20px;\n                  margin-top: -2px;",4,"ngIf"],[1,"ow",3,"ngClass"],[1,"flex","name_resp"],[1,"country_drpdown",3,"controlName","form"],[1,"phone_resp",3,"controlName","placeholder","form"],["class","align-subrow",4,"ngIf"],[1,"mandatory",2,"position","absolute","margin-left","20px","margin-top","-2px"],[1,"align-subrow"],[1,"create-another","enable-phonepin"],[1,"send-sms-checkbox"],[1,"assign-user-text",2,"position","relative","top","5px",3,"checked","checkedChange"],[1,"phone_error"],[2,"width","5%","padding-left","5px","padding-right","5px",3,"ngClass"],["src","assets/phone-lock.png","nbTooltipPlacement","top","nbTooltip","PIN"],[1,"pinplacholder","name_resp",2,"width","30%",3,"ngClass"],["autocomplete","off",3,"type","controlName","maxlength","placeholder","form","focusin","focusout"],[2,"position","absolute","width","140px",3,"key","form","isSubmitted"],[2,"width","5%","padding-left","12px",3,"ngClass"],["src","../../../../../assets/info-icon.svg","nbTooltip","The PIN length should be 4-digits. If you do not set a PIN, a randomly generated PIN will be sent.",1,"label-info-icon",3,"mouseenter"],[1,"assign_regionTeams_section","pointer","flex","space_between"],[3,"click"],["icon","plus-circle-outline"],[1,"right"],[1,"flex"],["src","assets/info-icon.svg","alt","reason icon",1,"label-info-icon","mr_10"],[3,"title","textToDisplay","proceedDelete"],[1,"pointer","red-color",2,"position","relative","top","5px",3,"ngClass"],[1,"fas","fa-trash","pointer","mr_10"],[3,"title","type","textToDisplay","proceedDelete"],[1,"pointer","red-color",2,"position","relative","top","5px"],[1,"create-another"],[2,"position","relative","top","3px",3,"checked","checkedChange"]],template:function(t,n){if(1&t){var i=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"nb-card"),e.TgZ(2,"nb-card-header",1),e.YNc(3,ue,3,0,"label",2),e.YNc(4,me,7,2,"span",2),e.qZA(),e.TgZ(5,"nb-card-body",3),e.YNc(6,he,9,1,"ng-template",4,5,e.W1O),e.TgZ(8,"form",6,7),e.NdJ("ngSubmit",function(){e.CHM(i);var p=e.MAs(9);return n.submit(p)}),e.YNc(10,fe,3,0,"div",8),e.TgZ(11,"div",9),e.TgZ(12,"div",10),e._UZ(13,"i",11),e.TgZ(14,"span",12),e._uU(15," *"),e.qZA(),e.qZA(),e.TgZ(16,"div",13),e.TgZ(17,"span"),e.TgZ(18,"app-autocomplete-tag-input",14),e.NdJ("changeClick",function(p){return n.onTagSelectionChange(p)}),e.qZA(),e.qZA(),e.TgZ(19,"div",15),e.TgZ(20,"span",16),e.YNc(21,ve,3,1,"span",17),e.TgZ(22,"span",18),e._UZ(23,"app-error-message",19),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(24,"div",20),e.qZA(),e.TgZ(25,"div",21),e.YNc(26,ke,37,32,"div",22),e.qZA(),e.YNc(27,Me,7,2,"div",23),e.TgZ(28,"span",24),e.TgZ(29,"span"),e.YNc(30,Oe,4,0,"span",25),e.YNc(31,Ie,5,5,"app-confirm-popup",26),e.YNc(32,Se,5,3,"app-confirm-popup",27),e.YNc(33,qe,3,1,"span",28),e.qZA(),e.TgZ(34,"span",29),e.TgZ(35,"app-button",30),e.NdJ("onClick",function(){return n.close()}),e._uU(36,"Cancel"),e.qZA(),e._UZ(37,"app-submit-button",31),e.qZA(),e.qZA(),e._UZ(38,"div",32),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&t){var a=e.MAs(9);e.xp6(3),e.Q6J("ngIf",!n.showDelete),e.xp6(1),e.Q6J("ngIf",n.showDelete),e.xp6(1),e.Q6J("nbSpinner",n.loading||n.rolesLoading),e.xp6(3),e.Q6J("formGroup",n.AddUserForm),e.xp6(2),e.Q6J("ngIf",n.showDelete&&!n.isEditingAccountOwner),e.xp6(1),e.Q6J("ngClass",e.VKq(22,Ne,n.isShowCheckbox())),e.xp6(7),e.Q6J("disableTags",n.disableStoreIds)("disabled",n.isEditingAccountOwner||n.isAllChecked)("data",null!=n.userDetails&&n.userDetails.assignments?n.userDetails.assignments:n.defaultAssignment)("placeholder",n.placeholder),e.xp6(3),e.Q6J("ngIf",n.isShowCheckbox()),e.xp6(2),e.Q6J("key","regionTeams")("form",n.AddUserForm)("isSubmitted",a.submitted),e.xp6(3),e.Q6J("ngForOf",n.users.controls),e.xp6(1),e.Q6J("ngIf",(null==n.selected?null:n.selected.length)>0),e.xp6(3),e.Q6J("ngIf",n.isShowDisclaimer()),e.xp6(1),e.Q6J("ngIf",n.isShowDelete()),e.xp6(1),e.Q6J("ngIf",n.isShowRemove()),e.xp6(1),e.Q6J("ngIf",!1===n.showDelete),e.xp6(4),e.Q6J("form",n.AddUserForm)("label",n.buttonLabel)}},directives:[h.Asz,h.ndF,k.O5,h.yKW,h.Q7R,k.sg,d._Y,d.JL,d.sg,A.w5,k.mk,h.jNv,ie.W,h.NTf,B.H,L.t,le,pe.X,h.fMN,de.D,Q.r,j.w],styles:['.footer_button[_ngcontent-%COMP%] {\n  justify-content: flex-end;\n}\n\n.fa-minus-circle[_ngcontent-%COMP%] {\n  color: #ff3d71;\n  cursor: pointer;\n}\n\n.Personal_details[_ngcontent-%COMP%] {\n  width: 100%;\n}\n\n.ow[_ngcontent-%COMP%] {\n  overflow-wrap: break-word;\n  word-wrap: break-word;\n  -webkit-hyphens: auto;\n          hyphens: auto;\n  width: 65%;\n}\n\n.ow[_ngcontent-%COMP%]   .phone_error[_ngcontent-%COMP%] {\n  width: 129px;\n  display: inline-block;\n}\n\n.mb-22[_ngcontent-%COMP%] {\n  margin-bottom: 22px !important;\n}\n\nnb-option-list.size-medium.ng-star-inserted.position-bottom[_ngcontent-%COMP%] {\n  width: 96.0625px;\n}\n\n.remove_user_icon[_ngcontent-%COMP%] {\n  position: absolute;\n  right: -13px;\n  top: -13px;\n}\n\n.popup_ui[_ngcontent-%COMP%] {\n  list-style: none;\n  padding-left: 5px;\n  margin-top: 5px;\n}\n\n.wrappper[_ngcontent-%COMP%] {\n  border-radius: 3px;\n  margin-top: 15px;\n  overflow: hidden;\n  padding: 1.5rem 1.5rem;\n  padding-bottom: 0px;\n}\n\nsize-medium[_ngcontent-%COMP%]   status-basic[_ngcontent-%COMP%]   shape-rectangle[_ngcontent-%COMP%]   ng-pristine[_ngcontent-%COMP%]   ng-invalid[_ngcontent-%COMP%]   nb-transition[_ngcontent-%COMP%]   ng-touched[_ngcontent-%COMP%] {\n  width: 90%;\n}\n\n.footer_button[_ngcontent-%COMP%]   .add_user[_ngcontent-%COMP%] {\n  margin-top: -16px !important;\n}\n\n.title[_ngcontent-%COMP%] {\n  display: contents;\n}\n\n.modal_wrapper[_ngcontent-%COMP%] {\n  width: 700px;\n}\n\n.modal_body_wrapper[_ngcontent-%COMP%] {\n  padding-left: 0px;\n  padding-right: 0px;\n  margin-top: 0px;\n  overflow: visible;\n}\n\n.placeholder_labels[_ngcontent-%COMP%] {\n  font-size: 11px;\n  color: #555353;\n  font-weight: 400;\n}\n\n.hide[_ngcontent-%COMP%] {\n  display: none;\n}\n\n.footer-add-user[_ngcontent-%COMP%] {\n  width: 400px;\n  display: flex;\n  justify-content: flex-end;\n}\n\n@media (max-width: 605px) and (min-width: 319px) {\n  .Personal_details[_ngcontent-%COMP%] {\n    width: 98%;\n  }\n  .Personal_details[_ngcontent-%COMP%]   .role_resp[_ngcontent-%COMP%] {\n    width: 7% !important;\n    padding-bottom: 4px;\n  }\n  .Personal_details[_ngcontent-%COMP%]   .pinplacholder[_ngcontent-%COMP%] {\n    width: 45% !important;\n  }\n  .Personal_details[_ngcontent-%COMP%]   .name_resp[_ngcontent-%COMP%] {\n    padding-bottom: 5px;\n    padding-left: 14px;\n    flex-direction: column;\n  }\n  .Personal_details[_ngcontent-%COMP%]   .email_resp[_ngcontent-%COMP%] {\n    width: 100% !important;\n    padding-bottom: 14px;\n  }\n  .Personal_details[_ngcontent-%COMP%]   .ow[_ngcontent-%COMP%] {\n    width: 100% !important;\n    padding-bottom: 20x;\n  }\n  .Personal_details[_ngcontent-%COMP%]   .ow[_ngcontent-%COMP%]   .phone_resp[_ngcontent-%COMP%] {\n    width: 95.2% !important;\n    margin-top: 5px;\n  }\n  .Personal_details[_ngcontent-%COMP%]   .pin_resp[_ngcontent-%COMP%] {\n    width: 100% !important;\n    padding-top: 20px;\n  }\n}\n\n@media (min-width: 610px) {\n  .para_txt_resp[_ngcontent-%COMP%] {\n    display: none !important;\n  }\n}\n\n@media (max-width: 609px) and (min-width: 320px) {\n  .phone[_ngcontent-%COMP%] {\n    margin-right: 0px !important;\n    margin-top: -5px !important;\n  }\n\n  .footer-add-user[_ngcontent-%COMP%] {\n    width: auto;\n    display: flex;\n    justify-content: flex-end;\n    margin-top: 5px;\n  }\n\n  .modal_wrapper[_ngcontent-%COMP%]   nb-card[_ngcontent-%COMP%]   nb-card-body[_ngcontent-%COMP%] {\n    padding: 0 !important;\n  }\n\n  .mandatory[_ngcontent-%COMP%] {\n    position: relative;\n    left: -1px;\n  }\n\n  .para_txt_resp[_ngcontent-%COMP%] {\n    display: block !important;\n  }\n}\n\n.info-search[_ngcontent-%COMP%] {\n  text-align: justify;\n  width: 452px;\n}\n\n.info-search[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] {\n  line-height: 2 !important;\n}\n\n@media (max-width: 341px) and (min-width: 320px) {\n  .info-search[_ngcontent-%COMP%] {\n    text-align: justify;\n    width: 180px !important;\n  }\n}\n\n@media (max-width: 550px) and (min-width: 340px) {\n  .info-search[_ngcontent-%COMP%] {\n    text-align: justify;\n    width: 210px !important;\n  }\n}\n\n@media (max-width: 700px) and (min-width: 549px) {\n  .info-search[_ngcontent-%COMP%] {\n    text-align: justify;\n    width: 310px !important;\n  }\n}\n\n@media (max-width: 550px) {\n  .search-user-resp[_ngcontent-%COMP%] {\n    overflow: auto;\n    max-height: 80vh;\n    padding: 0 4px;\n  }\n}\n\n.label-info-icon[_ngcontent-%COMP%] {\n  width: 13px;\n  cursor: pointer;\n}\n\n.add_another[_ngcontent-%COMP%] {\n  height: 30px;\n  width: 150px;\n  background-color: white !important;\n  color: #7b68ee !important;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.02), 0 1px 3px rgba(0, 0, 0, 0.14);\n  font-weight: normal !important;\n}\n\n.phone[_ngcontent-%COMP%] {\n  margin-right: 10px;\n}\n\n@media (min-width: 930px) {\n  .ow[_ngcontent-%COMP%]   .phone_resp[_ngcontent-%COMP%] {\n    width: 75%;\n  }\n\n  .pin_hidden[_ngcontent-%COMP%] {\n    width: 100%;\n  }\n  .pin_hidden[_ngcontent-%COMP%]   .phone_resp[_ngcontent-%COMP%] {\n    width: 79%;\n  }\n}\n\n@media (max-width: 930px) {\n  .ow[_ngcontent-%COMP%]   .phone_resp[_ngcontent-%COMP%] {\n    width: 75%;\n  }\n\n  .pin_hidden[_ngcontent-%COMP%] {\n    width: 100%;\n  }\n}\n\n.unassign-store[_ngcontent-%COMP%] {\n  background-color: #fd477c;\n  text-align: center;\n  box-shadow: none;\n  font-size: 13px;\n  font-weight: 500;\n  line-height: 1.2rem;\n  padding: 0.5rem 0.125rem;\n  color: white;\n  margin: auto;\n  width: 100%;\n  \n  position: relative;\n}\n\n.unassign-store[_ngcontent-%COMP%]::before {\n  position: absolute;\n  z-index: 1;\n  content: "";\n  right: calc(96% - 10px);\n  top: 28px;\n  border-style: solid;\n  border-width: 0 10px 10px 10px;\n  border-color: transparent transparent #fd477c transparent;\n  transition-duration: 0.3s;\n  transition-property: transform;\n  transform: rotate(180deg);\n}\n\n.sub-row[_ngcontent-%COMP%] {\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n}\n\n.assign-store-checkbox[_ngcontent-%COMP%] {\n  width: 75%;\n  display: inline-flex;\n}\n\n.send-sms-checkbox[_ngcontent-%COMP%] {\n  width: 100%;\n  display: inline-flex;\n}\n\n.error-msg[_ngcontent-%COMP%] {\n  width: 25%;\n}\n\n.modal-footer[_ngcontent-%COMP%] {\n  justify-content: space-between;\n  margin-bottom: 10px;\n  padding-right: 30px;\n  padding-left: 2.2rem;\n  margin-top: 5px;\n}\n\n@media (max-width: 500px) {\n  .modal-footer[_ngcontent-%COMP%] {\n    flex-direction: column;\n  }\n}\n\n.assign-user-txt[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n  margin-top: 5.5px;\n}\n\n.add_user_modal[_ngcontent-%COMP%]   .modal_body_wrapper[_ngcontent-%COMP%] {\n  max-height: -moz-fit-content;\n  max-height: fit-content;\n}\n\n@media (max-height: 571px) {\n  .add_user_modal[_ngcontent-%COMP%]   .modal_body_wrapper[_ngcontent-%COMP%] {\n    max-height: 50vh;\n    overflow-y: auto;\n  }\n  .add_user_modal[_ngcontent-%COMP%]   .wrappper[_ngcontent-%COMP%] {\n    margin-top: 0px;\n  }\n}\n\n.align-subrow[_ngcontent-%COMP%] {\n  display: flex;\n  justify-content: space-between;\n}\n\n.enable-phonepin[_ngcontent-%COMP%] {\n  margin-top: 1px;\n  display: flex;\n}\n\n@media (max-width: 600px) {\n  .align-subrow[_ngcontent-%COMP%] {\n    flex-direction: column;\n  }\n}']}),o}(),De=u(449),G=u(4266),K=u(3966);function Fe(o,s){if(1&o&&(e.TgZ(0,"span",12),e.TgZ(1,"span",13),e._UZ(2,"i",14),e._uU(3),e.qZA(),e.TgZ(4,"span",15),e._UZ(5,"app-dropdown-multi",16),e.qZA(),e.qZA()),2&o){var t=s.$implicit,n=e.oxw();e.xp6(3),e.hij(" ",null==t.controls||null==t.controls.regionName?null:t.controls.regionName.value," "),e.xp6(2),e.Q6J("max",10)("optionClass","dot-tag")("label","tags")("key","tag")("key2","color")("type","tag")("optionId","id")("Data",n.tags)("selected",null==t.controls.tagName?null:t.controls.tagName.value)("placeholder","Select one or more labels")("controlName","tagName")("form",t)("show",!1)}}var Je=function(){var o=function(){function s(t,n,i,a,r){var p=this;(0,O.Z)(this,s),this.gs=t,this.dataService=n,this.ref=i,this.fb=a,this.service=r,this.opacity=x.ZF,this.userDetails=this.userDetails,this.dataService.getCompanyUserTags(!1).then(function(l){p.tags=l})}return(0,M.Z)(s,[{key:"ngOnInit",value:function(){this.gs.logEvents("add_label_popup_opened"),this.getUserTags(),this.AddLabel=this.fb.group({storesArray:new d.Oe([])}),this.userDetails=this.userDetails,this.setCommonStores()}},{key:"getUserTags",value:function(){return(0,I.mG)(this,void 0,void 0,y().mark(function n(){return y().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,this.loading=!0,r.next=4,this.service.getUserTags({user_id:this.userDetails.id});case 4:this.assignedTags=r.sent.data,this.preselectForm(),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(0),this.gs.showToastError(r.t0.message);case 12:return r.prev=12,this.loading=!1,r.finish(12);case 15:case"end":return r.stop()}},n,this,[[0,9,12,15]])}))}},{key:"preselectForm",value:function(){var i,n=this;!this.assignedTags||0==(null===(i=this.assignedTags)||void 0===i?void 0:i.length)||this.stores.controls.forEach(function(a){var r,p=n.assignedTags.filter(function(l){return l.region_id==a.value.regionId});a.get("tagName").setValue(null===(r=p[0])||void 0===r?void 0:r.tags)})}},{key:"populateForm",value:function(){var n=this;this.commonStores.forEach(function(i){n.stores.push(n.fb.group({regionId:[i.region_id],regionName:[i.region_title],tagName:[]}))})}},{key:"stores",get:function(){return this.form.storesArray}},{key:"form",get:function(){return this.AddLabel.controls}},{key:"submit",value:function(n){return(0,I.mG)(this,void 0,void 0,y().mark(function i(){var a,r;return y().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a={user_id:this.userDetails.id,data:this.getSelectedTags()},l.prev=1,this.loading=!0,l.next=5,this.service.updateUserTags(a);case 5:this.gs.showToastSuccess(null==(r=l.sent)?void 0:r.message),this.close(!0),l.next=13;break;case 10:l.prev=10,l.t0=l.catch(1),this.gs.showToastError(l.t0.message);case 13:return l.prev=13,this.loading=!1,l.finish(13);case 16:case"end":return l.stop()}},i,this,[[1,10,13,16]])}))}},{key:"getSelectedTags",value:function(){return this.stores.controls.map(function(i){return{region_id:i.value.regionId,tags:i.value.tagName?i.value.tagName:[]}})}},{key:"close",value:function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.ref.close(n)}},{key:"setCommonStores",value:function(){var n=this.dataService.getLoggedInUserStores();this.commonStores=this.userDetails.regions.filter(function(i){return n.some(function(a){return i.region_id===a.region_id})}),this.populateForm()}}]),s}();return o.\u0275fac=function(t){return new(t||o)(e.Y36(D.m),e.Y36(q.s),e.Y36(h.X4l),e.Y36(d.qu),e.Y36(F.K))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-label"]],inputs:{userDetails:"userDetails"},decls:17,vars:8,consts:[[1,"modal_wrapper","add_label"],[1,"card_header"],[1,"title"],[1,"search-user-resp",3,"nbSpinner"],["id","form",3,"formGroup","ngSubmit"],["ngForm","ngForm"],["size","medium",1,"user-table",3,"name","color","initialColor"],[1,"modal_body_wrapper","stores-container"],["class","stores-row",4,"ngFor","ngForOf"],[1,"flex","footer-btns-row"],[3,"onClick"],[3,"form","label"],[1,"stores-row"],[1,"storeinfo"],[1,"fas","fa-store","icon-color"],[1,"dropdown-multiselect"],[3,"max","optionClass","label","key","key2","type","optionId","Data","selected","placeholder","controlName","form","show"]],template:function(t,n){if(1&t){var i=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"nb-card"),e.TgZ(2,"nb-card-header",1),e.TgZ(3,"label"),e.TgZ(4,"b",2),e._uU(5,"Add Label"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"nb-card-body",3),e.TgZ(7,"form",4,5),e.NdJ("ngSubmit",function(){e.CHM(i);var r=e.MAs(8);return n.submit(r)}),e._UZ(9,"app-user-avatar",6),e.TgZ(10,"div",7),e.YNc(11,Fe,6,14,"span",8),e.qZA(),e.TgZ(12,"div"),e.TgZ(13,"span",9),e.TgZ(14,"app-button",10),e.NdJ("onClick",function(){return n.close()}),e._uU(15,"Cancel"),e.qZA(),e._UZ(16,"app-submit-button",11),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}2&t&&(e.xp6(6),e.Q6J("nbSpinner",n.loading),e.xp6(1),e.Q6J("formGroup",n.AddLabel),e.xp6(2),e.Q6J("name",n.userDetails.name)("color",n.userDetails.user_color+n.opacity)("initialColor",n.userDetails.user_color),e.xp6(2),e.Q6J("ngForOf",n.stores.controls),e.xp6(5),e.Q6J("form",n.AddLabel)("label","Add"))},directives:[h.Asz,h.ndF,h.yKW,h.Q7R,d._Y,d.JL,d.sg,A.w5,G.k,k.sg,K.x,Q.r,j.w],styles:[".title[_ngcontent-%COMP%] {\n  display: contents;\n}\n\n.stores-row[_ngcontent-%COMP%] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10px;\n  margin-top: 10px;\n}\n\n.storeinfo[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n  width: 30%;\n}\n\n.storeinfo[_ngcontent-%COMP%]   i[_ngcontent-%COMP%] {\n  margin-right: 5px;\n}\n\n.user-table[_ngcontent-%COMP%] {\n  border-bottom: 1px solid #eaeaea;\n  padding-bottom: 10px;\n}\n\n.stores-container[_ngcontent-%COMP%] {\n  padding-left: 0px !important;\n  padding-right: 0px !important;\n}\n\n.dropdown-multiselect[_ngcontent-%COMP%] {\n  width: 70%;\n}\n\n.footer-btns-row[_ngcontent-%COMP%] {\n  justify-content: flex-end;\n  margin-top: 20px;\n  margin-bottom: 10px;\n}"]}),o}(),Ve=u(605),Re=u(3863),Qe=u(3963),W=u(1201),X=u(5116),Ee=u(6484),Ye=u(9920),He=["emailFilter"],ze=["phoneFilter"],Be=["emailFilterResp"],Le=["phoneFilterResp"];function $e(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"span",17),e.TgZ(1,"app-filter-popup",8),e.NdJ("onClose",function(){return e.CHM(t),e.oxw(2).closeFilter("tag")})("onApply",function(){return e.CHM(t),e.oxw(2).applyFilterMulti("tag")})("onClear",function(){return e.CHM(t),e.oxw(2).removeFilter("tag")})("onOpen",function(){e.CHM(t);var a=e.oxw(2);return a.defaultOpen=!a.defaultOpen}),e._UZ(2,"app-dropdown-multi",18),e.qZA(),e.qZA()}if(2&o){var n=e.oxw(2);e.xp6(1),e.Q6J("label","Tags")("isFiltered",null==n.isFiltered?null:n.isFiltered.tag),e.xp6(1),e.Q6J("label","tags")("defaultOpen",n.defaultOpen2)("selected",null==n.filter?null:n.filter.tag)("key","tag")("type","tag")("optionClass","dot-tag")("key2","color")("optionId","id")("Data",n.tags)("placeholder","Select one or more tags")("controlName","tag")("form",n.form)("show",!1)}}function je(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"span",5),e.YNc(1,$e,3,15,"span",6),e.TgZ(2,"span",7),e.TgZ(3,"app-filter-popup",8),e.NdJ("onClose",function(){return e.CHM(t),e.oxw().closeFilter("role")})("onApply",function(){return e.CHM(t),e.oxw().applyFilterMulti("role")})("onClear",function(){return e.CHM(t),e.oxw().removeFilter("role")})("onOpen",function(){e.CHM(t);var a=e.oxw();return a.defaultOpen=!a.defaultOpen}),e._UZ(4,"app-dropdown-multi",9),e.qZA(),e.qZA(),e.TgZ(5,"span",10),e.TgZ(6,"app-filter-popup",11,12),e.NdJ("onClose",function(){return e.CHM(t),e.oxw().closeFilter("email")})("onApply",function(){return e.CHM(t),e.oxw().applyFilter("email")})("onClear",function(){return e.CHM(t),e.oxw().removeFilter("email")}),e.TgZ(8,"app-text-input",13),e.NdJ("onEnter",function(){return e.CHM(t),e.oxw().onEnter("emailFilterResp")}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"span",14),e.TgZ(10,"app-filter-popup",11,15),e.NdJ("onClose",function(){return e.CHM(t),e.oxw().closeFilter("phone")})("onApply",function(){return e.CHM(t),e.oxw().applyFilter("phone")})("onClear",function(){return e.CHM(t),e.oxw().removeFilter("phone")}),e.TgZ(12,"app-text-input",13),e.NdJ("onEnter",function(){return e.CHM(t),e.oxw().onEnter("phoneFilterResp")}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"app-sort",16),e.NdJ("onSort",function(a){return e.CHM(t),e.oxw().onSort(a,"name_sort")}),e.qZA(),e.qZA()}if(2&o){var n=e.oxw();e.xp6(1),e.Q6J("ngIf",(null==n.tags?null:n.tags.length)>0),e.xp6(2),e.Q6J("label","Roles")("isFiltered",null==n.isFiltered?null:n.isFiltered.role),e.xp6(1),e.Q6J("label","roles")("defaultOpen",n.defaultOpen)("selected",null==n.filters?null:n.filters.role)("key","role_title")("optionId","role_id")("Data",n.roles)("placeholder","Select one or more roles")("controlName","role")("form",n.form)("show",!1),e.xp6(2),e.Q6J("label","Email")("isFiltered",n.isFiltered.email),e.xp6(2),e.Q6J("placeholder","Enter email to search")("controlName","email")("form",n.form),e.xp6(2),e.Q6J("label","Phone")("isFiltered",n.isFiltered.phone),e.xp6(2),e.Q6J("placeholder","Enter phone to search")("controlName","phone")("form",n.form),e.xp6(1),e.Q6J("order",null==n.filters?null:n.filters.name_sort)("isSelected",null!==(null==n.isFiltered?null:n.isFiltered.name_sort))("label","Name")}}function Ge(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"mat-paginator",19),e.NdJ("page",function(a){e.CHM(t);var r=e.oxw();return r.pageEvent=a,r.getData()}),e.qZA()}if(2&o){var n=e.oxw();e.Q6J("length",n.paginator.total_records)("pageIndex",n.paginator.page_no-1)("pageSize",n.paginator.page_size)("pageSizeOptions",n.pageSizes)}}function Ke(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"span",17),e.TgZ(1,"app-filter-popup",8),e.NdJ("onClose",function(){return e.CHM(t),e.oxw(3).closeFilter("tag")})("onApply",function(){return e.CHM(t),e.oxw(3).applyFilterMulti("tag")})("onClear",function(){return e.CHM(t),e.oxw(3).removeFilter("tag")})("onOpen",function(){e.CHM(t);var a=e.oxw(3);return a.defaultOpen=!a.defaultOpen}),e._UZ(2,"app-dropdown-multi",45),e.qZA(),e.qZA()}if(2&o){var n=e.oxw(3);e.xp6(1),e.Q6J("label","Tags")("isFiltered",null==n.isFiltered?null:n.isFiltered.tag),e.xp6(1),e.Q6J("type","tag")("optionClass","dot-tag")("label","tags")("defaultOpen",n.defaultOpen2)("selected",null==n.filter?null:n.filter.tag)("key","tag")("key2","color")("optionId","id")("Data",n.tags)("placeholder","Select one or more tags")("controlName","tag")("form",n.form)("show",!1)}}function We(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"th",43),e._uU(1,"Name "),e.TgZ(2,"app-sort",44),e.NdJ("onSort",function(a){return e.CHM(t),e.oxw(2).onSort(a,"name_sort")}),e.qZA(),e.YNc(3,Ke,3,15,"span",6),e.qZA()}if(2&o){var n=e.oxw(2);e.xp6(2),e.Q6J("order",null==n.filters?null:n.filters.name_sort)("isSelected",null!==(null==n.isFiltered?null:n.isFiltered.name_sort)),e.xp6(1),e.Q6J("ngIf",(null==n.tags?null:n.tags.length)>0)}}function Xe(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"div",55),e.NdJ("click",function(i){e.CHM(t);var a=e.oxw().$implicit,r=e.oxw(2);return i.stopPropagation(),r.openLabelModal(a)}),e._UZ(1,"i",56),e._uU(2,"Add label"),e.qZA()}}function en(o,s){if(1&o&&(e.ynx(0),e.TgZ(1,"span",57),e._uU(2),e.qZA(),e.BQk()),2&o){var t=s.$implicit;e.xp6(1),e.Udp("background-color",t.color),e.xp6(1),e.Oqu(t.tag)}}function nn(o,s){if(1&o&&(e.TgZ(0,"span",57),e._uU(1),e.qZA()),2&o){var t=e.oxw().$implicit;e.Udp("background-color","#edeef4"),e.xp6(1),e.hij("+",t.tagsCount-2,"")}}var tn=function(s){return{link_name:s}};function on(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"td",46),e.NdJ("click",function(){var p=e.CHM(t).$implicit;return e.oxw(2).selectRow(p)}),e.TgZ(1,"div",47),e.TgZ(2,"label",48),e._uU(3,"Name "),e.qZA(),e.TgZ(4,"span",49),e._UZ(5,"app-user-avatar",50),e.YNc(6,Xe,3,0,"div",51),e.TgZ(7,"span",52),e.NdJ("click",function(r){var l=e.CHM(t).$implicit,m=e.oxw(2);return r.stopPropagation(),m.openLabelModal(l)}),e.YNc(8,en,3,3,"ng-container",53),e.ALo(9,"slice"),e.YNc(10,nn,2,3,"span",54),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){var n=s.$implicit,i=e.oxw(2);e.xp6(5),e.Tol(e.VKq(13,tn,"user-detail"===i.type&&!n.is_account_owner)),e.s9C("name",n.name),e.Q6J("color",n.user_color+i.opacity)("initialColor",n.user_color)("nbTooltip",n.name),e.xp6(1),e.Q6J("ngIf",(null==i.tags?null:i.tags.length)>0&&!n.is_account_owner&&!n.is_partner&&(!n.tags||(null==n.tags?null:n.tags.length)<1)),e.xp6(2),e.Q6J("ngForOf",e.Dn7(9,9,n.tags,0,2)),e.xp6(2),e.Q6J("ngIf",n.tagsCount>2)}}function an(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"app-filter-popup",8),e.NdJ("onClose",function(){return e.CHM(t),e.oxw(3).closeFilter("role")})("onApply",function(){return e.CHM(t),e.oxw(3).applyFilterMulti("role")})("onClear",function(){return e.CHM(t),e.oxw(3).removeFilter("role")})("onOpen",function(){e.CHM(t);var a=e.oxw(3);return a.defaultOpen=!a.defaultOpen}),e._UZ(1,"app-dropdown-multi",9),e.qZA()}if(2&o){var n=e.oxw(3);e.Q6J("label","roles")("isFiltered",null==n.isFiltered?null:n.isFiltered.role),e.xp6(1),e.Q6J("label","roles")("defaultOpen",n.defaultOpen)("selected",null==n.filters?null:n.filters.role)("key","role_title")("optionId","role_id")("Data",n.roles)("placeholder","Select one or more roles")("controlName","role")("form",n.form)("show",!1)}}function sn(o,s){if(1&o&&(e.TgZ(0,"th",43),e._uU(1," Role "),e.YNc(2,an,2,12,"app-filter-popup",58),e.qZA()),2&o){var t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",!(null!=t.gs&&t.gs.isRespMode))}}function rn(o,s){if(1&o&&(e.TgZ(0,"td",59),e.TgZ(1,"span",60),e.TgZ(2,"span",61),e.TgZ(3,"label",48),e._uU(4,"Role "),e.qZA(),e.TgZ(5,"span"),e._uU(6),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o){var t=s.$implicit;e.xp6(6),e.hij(" ",t.role_title," ")}}function ln(o,s){1&o&&(e.TgZ(0,"th",43),e._uU(1,"Store"),e.qZA())}function pn(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"span",65),e.NdJ("mouseenter",function(){e.CHM(t);var r=e.oxw(2).$implicit;return e.oxw(2).OnHover(r)}),e._uU(1),e.ALo(2,"regionsTeams"),e.qZA()}if(2&o){var n=e.oxw(2).$implicit,i=e.oxw(2);e.Q6J("nbTooltip",i.regions),e.xp6(1),e.hij(" ",e.Dn7(2,2,n,i.regionConfig,i.teamConfig)," ")}}function dn(o,s){if(1&o&&(e.TgZ(0,"span"),e.YNc(1,pn,3,6,"span",64),e.qZA()),2&o){var t=e.oxw().$implicit,n=e.MAs(6);e.xp6(1),e.Q6J("ngIf",!t.is_account_owner&&!t.is_partner)("ngIfElse",n)}}function cn(o,s){if(1&o&&(e.TgZ(0,"span",67),e._uU(1),e.ALo(2,"regionsTeams"),e.qZA()),2&o){var t=e.oxw(2).$implicit,n=e.oxw(2);e.xp6(1),e.hij(" ",e.Dn7(2,1,t,n.regionConfig,n.teamConfig)," ")}}function un(o,s){if(1&o&&(e.TgZ(0,"span"),e.YNc(1,cn,3,5,"span",66),e.qZA()),2&o){var t=e.oxw().$implicit,n=e.MAs(6);e.xp6(1),e.Q6J("ngIf",!t.is_account_owner&&!t.is_partner&&(null==t||null==t.regions?null:t.regions.length)<2)("ngIfElse",n)}}function mn(o,s){if(1&o&&(e.TgZ(0,"span",68),e._uU(1),e.qZA()),2&o){var t=e.oxw(3);e.xp6(1),e.hij(" All ",null==t.nameConfig?null:t.nameConfig.region_plural," ")}}function gn(o,s){if(1&o&&(e.TgZ(0,"td",59),e.TgZ(1,"label",48),e._uU(2,"Store "),e.qZA(),e.YNc(3,dn,2,2,"span",62),e.YNc(4,un,2,2,"span",62),e.YNc(5,mn,2,1,"ng-template",null,63,e.W1O),e.qZA()),2&o){var t=s.$implicit;e.xp6(3),e.Q6J("ngIf",(null==t||null==t.regions?null:t.regions.length)>1),e.xp6(1),e.Q6J("ngIf",(null==t||null==t.regions?null:t.regions.length)<2)}}function _n(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"th",69),e._uU(1,"Email "),e.TgZ(2,"app-filter-popup",11,70),e.NdJ("onClose",function(){return e.CHM(t),e.oxw(2).closeFilter("email")})("onApply",function(){return e.CHM(t),e.oxw(2).applyFilter("email")})("onClear",function(){return e.CHM(t),e.oxw(2).removeFilter("email")}),e.TgZ(4,"app-text-input",71),e.NdJ("keydown.enter",function(){return e.CHM(t),e.oxw(2).onEnter("emailFilter")}),e.qZA(),e.qZA(),e.qZA()}if(2&o){var n=e.oxw(2);e.xp6(2),e.Q6J("label","email")("isFiltered",n.isFiltered.email),e.xp6(2),e.Q6J("placeholder","Enter email to search")("controlName","email")("form",n.form)}}function hn(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"span",78),e.NdJ("click",function(){e.CHM(t);var a=e.oxw().$implicit;return e.oxw(2).resendInvite(a.id,"web")}),e._UZ(1,"img",79),e.qZA()}if(2&o){var n=e.oxw().$implicit;e.Tol(!n.is_account_owner&&n.resend_web_invite?"relative pointer":"hide-active-email")}}function fn(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"span",80),e.NdJ("click",function(){e.CHM(t);var a=e.oxw().$implicit;return e.oxw(2).resendInvite(a.id,"web")}),e._UZ(1,"img",79),e.qZA()}if(2&o){var n=e.oxw().$implicit;e.Tol(!n.is_account_owner&&n.resend_web_invite?"relative pointer":"hide-active-email")}}function vn(o,s){if(1&o&&(e.TgZ(0,"td",72),e.TgZ(1,"div",73),e.YNc(2,hn,2,2,"span",74),e.TgZ(3,"span",75),e._uU(4),e.qZA(),e.qZA(),e.TgZ(5,"div",76),e.TgZ(6,"label",48),e._uU(7,"Email"),e.qZA(),e.TgZ(8,"span",75),e._uU(9),e.qZA(),e.YNc(10,fn,2,2,"span",77),e.qZA(),e.qZA()),2&o){var t=s.$implicit;e.xp6(2),e.Q6J("ngIf",t.email),e.xp6(2),e.hij(" ",t.email," "),e.xp6(5),e.hij(" ",t.email," "),e.xp6(1),e.Q6J("ngIf",t.email)}}function Cn(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"th",81),e._uU(1,"Phone number "),e.TgZ(2,"app-filter-popup",11,82),e.NdJ("onClose",function(){return e.CHM(t),e.oxw(2).closeFilter("phone")})("onApply",function(){return e.CHM(t),e.oxw(2).applyFilter("phone")})("onClear",function(){return e.CHM(t),e.oxw(2).removeFilter("phone")}),e.TgZ(4,"app-text-input",71),e.NdJ("keydown.enter",function(){return e.CHM(t),e.oxw(2).onEnter("phoneFilter")}),e.qZA(),e.qZA(),e.qZA()}if(2&o){var n=e.oxw(2);e.xp6(2),e.Q6J("label","phone")("isFiltered",n.isFiltered.phone),e.xp6(2),e.Q6J("placeholder","Enter phone to search")("controlName","phone")("form",n.form)}}function bn(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"span",87),e.NdJ("click",function(){e.CHM(t);var i=e.oxw().$implicit;return e.oxw(2).resendInvite(i.id,"mobile")}),e.qZA()}}function Tn(o,s){if(1&o&&(e.TgZ(0,"td",83),e.TgZ(1,"div",84),e.TgZ(2,"label",48),e._uU(3,"Phone number "),e.qZA(),e.YNc(4,bn,1,0,"span",85),e.TgZ(5,"span",86),e._uU(6),e.ALo(7,"phoneNumber"),e.qZA(),e.qZA(),e.qZA()),2&o){var t=s.$implicit;e.xp6(4),e.Q6J("ngIf",!t.is_account_owner&&t.resend_mobile_invite),e.xp6(2),e.hij(" ",e.lcZ(7,2,t.phone_number)," ")}}function wn(o,s){1&o&&(e.TgZ(0,"th",43),e._uU(1,"Status"),e.qZA())}var xn=function(s,t){return{active:s,pending:t}};function Zn(o,s){if(1&o&&(e.TgZ(0,"td",88),e.TgZ(1,"label",48),e._uU(2,"Status"),e.qZA(),e.TgZ(3,"span",89),e._uU(4),e.qZA(),e.qZA()),2&o){var t=s.$implicit;e.xp6(3),e.Q6J("ngClass",e.WLB(2,xn,"Active"===t.status,"Pending"===t.status)),e.xp6(1),e.hij(" ",t.status," ")}}function yn(o,s){1&o&&(e.TgZ(0,"th",90),e._uU(1,"ACTION"),e.qZA())}function An(o,s){1&o&&(e.TgZ(0,"td",91),e.TgZ(1,"span"),e._uU(2," Unassign "),e.qZA(),e.qZA())}function Un(o,s){1&o&&e._UZ(0,"tr",92)}var kn=function(s){return{disable_row:s}};function Mn(o,s){1&o&&e._UZ(0,"tr",93),2&o&&e.Q6J("ngClass",e.VKq(1,kn,s.$implicit.is_empty))}function On(o,s){if(1&o&&(e.TgZ(0,"div",20),e.TgZ(1,"table",21),e.ynx(2,22),e.YNc(3,We,4,3,"th",23),e.YNc(4,on,11,15,"td",24),e.BQk(),e.ynx(5,25),e.YNc(6,sn,3,1,"th",23),e.YNc(7,rn,7,1,"td",26),e.BQk(),e.ynx(8,27),e.YNc(9,ln,2,0,"th",23),e.YNc(10,gn,7,2,"td",26),e.BQk(),e.ynx(11,28),e.YNc(12,_n,5,5,"th",29),e.YNc(13,vn,11,4,"td",30),e.BQk(),e.ynx(14,31),e.YNc(15,Cn,5,5,"th",32),e.YNc(16,Tn,8,4,"td",33),e.BQk(),e.ynx(17,34),e.YNc(18,wn,2,0,"th",23),e.YNc(19,Zn,5,5,"td",35),e.BQk(),e.ynx(20,36),e.YNc(21,yn,2,0,"th",37),e.YNc(22,An,3,0,"td",38),e.BQk(),e.YNc(23,Un,1,0,"tr",39),e.YNc(24,Mn,1,3,"tr",40),e.qZA(),e._UZ(25,"app-no-records",41),e._UZ(26,"app-no-search-records",42),e.qZA()),2&o){var t=e.oxw();e.xp6(1),e.Q6J("id",t.type)("dataSource",t.dataSource.data),e.xp6(22),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(1),e.Q6J("display",t.emptyResults)("animation",t.animation)("animation2",t.animation2)("textMessage",t.textMessage),e.xp6(1),e.Q6J("display",!t.emptyResults&&t.emptySearchResults)}}var ee=function(){var o=function(){function s(t,n,i,a,r,p,l,m){var _=this;(0,O.Z)(this,s),this.http=t,this.fb=n,this.dialogService=i,this.dataService=a,this.cdRef=r,this.service=p,this.gs=l,this.analytics=m,this.displayedColumns=["name","role","regionsAndTeams","email","phone_number","status"],this.dataSource=new T.by([]),this.totalUsers=new e.vpe,this.selectionUser=new e.vpe,this.callRegionHierarchy=new e.vpe,this.sharedRegion=0,this.check=0,this.defaultOpen=!0,this.defaultOpen2=!0,this.filters={role:null,email:null,phone:null,name_sort:1,tag:null},this.pageSizes=x.Wv,this.dataService.getConfigurations(!1).then(function(c){var v,C,g,P;_.nameConfig=null===(v=c.company)||void 0===v?void 0:v.custom_names,_.regionConfig=null===(C=_.nameConfig)||void 0===C?void 0:C.region_plural,_.teamConfig=null===(g=_.nameConfig)||void 0===g?void 0:g.team_plural,_.isTeam=1===(null===(P=c.company)||void 0===P?void 0:P.is_team)}).finally(function(){}),this.subscription=this.dataService.SharingRegionData.subscribe(function(c){_.sharedRegion=c,_.getData()}),this.dataService.getRoles(!1).then(function(c){_.roles=c}).finally(function(){}),this.dataService.getCompanyUserTags(!1).then(function(c){_.tags=c})}return(0,M.Z)(s,[{key:"ngOnInit",value:function(){this.filters={role:null,email:null,phone:null,name_sort:1,tag:null},this.isFiltered={role:!1,email:!1,phone:!1,tag:!1},this.opacity=x.ZF,this.paginator=x.$0,this.selectedUserName=null,this.gs.showBackDrop(!1),this.isActive=null,this.animation="organization",this.textMessage="Get started by adding users to your store.",this.form=this.fb.group({role:[],tag:[],email:[],phone:[]})}},{key:"closeFilter",value:function(n){var i;this.form.controls[n].setValue(null===(i=this.filters)||void 0===i?void 0:i[n])}},{key:"onSort",value:function(n,i){this.gs.logEvents("organisation_page_"+i),this.filters[i]=n,this.getData()}},{key:"onEnter",value:function(n){this[n].applyEnter()}},{key:"applyFilterMulti",value:function(n){this.gs.logEvents("users_filtered_by_"+n+"_organisation");var i=this.form.controls[n].value;i&&i.length>0?(this.isFiltered[n]=!0,this.filters[n]=i):(this.filters[n]=null,this.isFiltered[n]=!1),this.getData()}},{key:"applyFilter",value:function(n){this.gs.logEvents("users_filtered_by_"+n+"_organisation");var i=this.form.controls[n].value;i&&i.length>0?(this.isFiltered[n]=!0,this.filters[n]=i):(this.filters[n]=null,this.isFiltered[n]=!1),this.getData()}},{key:"removeFilter",value:function(n){this.filters[n]=null,this.isFiltered[n]=!1,this.getData()}},{key:"initSelection",value:function(){this.selection=new De.Ov(!0,[])}},{key:"ngAfterViewChecked",value:function(){this.cdRef.detectChanges()}},{key:"ngOnChanges",value:function(n){var i=this,a=!1;n.selectedTab&&n.selectedTab.currentValue!==n.selectedTab.previousValue&&(this.dataSource.data=null,this.animation="timesheet",this.animation2=null,this.textMessage="No active users.","all_users"===this.selectedTab?(this.animation="organization",this.animation2="arrowBottom",this.textMessage="Get started by adding users to your store."):"pending_users"===this.selectedTab&&(this.textMessage="No pending users."),a=!0),n.searchText&&n.searchText.currentValue!==n.searchText.previousValue?(this.pageEvent&&(this.pageEvent.pageIndex=0),a=!0):n.filterData&&n.filterData.currentValue!==n.filterData.previousValue&&(this.filterInput=n.filterData.currentValue,a=!0),setTimeout(function(){a&&i.getData()})}},{key:"numberOfUsers",value:function(n){this.totalUsers.emit(n)}},{key:"resendInvite",value:function(n,i){var a=this;this.analytics.logEvents("resend_email"),this.loading=!0,this.service.resendInvite({user_id:n,resend_mobile_invite:"mobile"===i,resend_web_invite:"web"===i}).then(function(p){a.gs.showToastSuccess(null==p?void 0:p.message)}).catch(function(p){console.log(p),a.gs.showToastError(null==p?void 0:p.message)}).finally(function(){a.loading=!1})}},{key:"openLabelModal",value:function(n){var i=this;n.is_empty||(this.selectedRowData=n,this.dialogService.open(Je,{hasBackdrop:!0,closeOnBackdropClick:!1,context:{userDetails:n}}).onClose.subscribe(function(a){a&&i.getData()}))}},{key:"selectRow",value:function(n){var i=this;n.is_empty||(this.selectedRowData=n,this.dialogService.open(Y,{hasBackdrop:!0,closeOnBackdropClick:!1,context:{userDetails:n}}).onClose.subscribe(function(a){a&&(a.refresh&&(i.getData(),i.getAllUsersCount()),i.callRegionHierarchy.emit())}))}},{key:"getData",value:function(){var n=this;if(null!=this.selectedTab&&(this.dataSource.data=null,null!=this.sharedRegion)){this.filterInput={region_id:this.sharedRegion},this.loading=!0;var i="active_users"===this.selectedTab?1:"pending_users"===this.selectedTab?0:null;this.displayedColumns=1==i||0==i?["name","role","regionsAndTeams","email","phone_number"]:["name","role","regionsAndTeams","email","phone_number","status"],this.service.getUsersTableData(i,this.searchText,this.pageEvent,this.filterInput,this.filters).then(function(a){var r,p;n.dataSource.data=a.users,n.paginator=a.pagination,n.numberOfUsers(a.total);var l=!1;for(var m in n.isFiltered)if(1==n.isFiltered[m]){l=!0;break}n.emptySearchResults=!(0!==(null===(r=a.users)||void 0===r?void 0:r.length)||!n.searchText&&!l),n.emptyResults=0===(null===(p=a.users)||void 0===p?void 0:p.length)&&!n.searchText&&!l}).catch(function(a){console.log(a)}).finally(function(){return(0,I.mG)(n,void 0,void 0,y().mark(function a(){return y().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:this.loading=!1;case 1:case"end":return p.stop()}},a,this)}))})}}},{key:"getAllUsersCount",value:function(){var n=this;this.loading=!0,this.service.getUsersExist().then(function(i){n.gs.setUsersCount(null==i?void 0:i.users_exist_flag)}).catch(function(i){console.log(i)}).finally(function(){n.loading=!1})}},{key:"OnHover",value:function(n){var i;this.regions=null===(i=null==n?void 0:n.regions)||void 0===i?void 0:i.map(function(a){return a.region_title}).join(", ")}},{key:"ngOnDestroy",value:function(){var n;null===(n=this.subscription)||void 0===n||n.unsubscribe()}}]),s}();return o.\u0275fac=function(t){return new(t||o)(e.Y36($.s),e.Y36(d.qu),e.Y36(h.Gln),e.Y36(q.s),e.Y36(e.sBO),e.Y36(F.K),e.Y36(D.m),e.Y36(R.C))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-user-table-view"]],viewQuery:function(t,n){var i;1&t&&(e.Gf(S.NW,5),e.Gf(He,5),e.Gf(ze,5),e.Gf(Be,5),e.Gf(Le,5)),2&t&&(e.iGM(i=e.CRH())&&(n.MatPaginator=i.first),e.iGM(i=e.CRH())&&(n.emailFilter=i.first),e.iGM(i=e.CRH())&&(n.phoneFilter=i.first),e.iGM(i=e.CRH())&&(n.emailFilterResp=i.first),e.iGM(i=e.CRH())&&(n.phoneFilterResp=i.first))},inputs:{searchText:"searchText",filterData:"filterData",checked:"checked",selectedTab:"selectedTab",type:"type",action:"action"},outputs:{totalUsers:"totalUsers",selectionUser:"selectionUser",callRegionHierarchy:"callRegionHierarchy"},features:[e.TTD],decls:5,vars:4,consts:[[3,"loading"],["class","filters-wrapper",4,"ngIf"],[1,"user_page_pagination"],["showFirstLastButtons","",3,"length","pageIndex","pageSize","pageSizeOptions","page",4,"ngIf"],["class","mat-elevation-z8 relative view_resp_org","style","top: 0px;",4,"ngIf"],[1,"filters-wrapper"],["class","roles-filter",4,"ngIf"],[1,""],[3,"label","isFiltered","onClose","onApply","onClear","onOpen"],[3,"label","defaultOpen","selected","key","optionId","Data","placeholder","controlName","form","show"],[1,"email-filter"],[3,"label","isFiltered","onClose","onApply","onClear"],["emailFilterResp",""],[3,"placeholder","controlName","form","onEnter"],[1,"phone-filter"],["phoneFilterResp",""],[1,"email-filter",3,"order","isSelected","label","onSort"],[1,"roles-filter"],[3,"label","defaultOpen","selected","key","type","optionClass","key2","optionId","Data","placeholder","controlName","form","show"],["showFirstLastButtons","",3,"length","pageIndex","pageSize","pageSizeOptions","page"],[1,"mat-elevation-z8","relative","view_resp_org",2,"top","0px"],["mat-table","",1,"resp_org_table",3,"id","dataSource"],["matColumnDef","name"],["mat-header-cell","","style","width: 20%;",4,"matHeaderCellDef"],["mat-cell","","style","width: 20%",3,"click",4,"matCellDef"],["matColumnDef","role"],["mat-cell","","style","width: 20%;",4,"matCellDef"],["matColumnDef","regionsAndTeams"],["matColumnDef","email"],["mat-header-cell","","class","email-col","style","width: 20%; padding-left: 38px !important;",4,"matHeaderCellDef"],["mat-cell","","class","email-col","style","width: 20%",4,"matCellDef"],["matColumnDef","phone_number"],["mat-header-cell","","class","phone-col","style","width: 20%;",4,"matHeaderCellDef"],["mat-cell","","class","phone-col","style","width: 20%;",4,"matCellDef"],["matColumnDef","status"],["mat-cell","","class","status_badge","style","width: 20%;",4,"matCellDef"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","showhim",3,"ngClass",4,"matRowDef","matRowDefColumns"],[3,"display","animation","animation2","textMessage"],[3,"display"],["mat-header-cell","",2,"width","20%"],[3,"order","isSelected","onSort"],[3,"type","optionClass","label","defaultOpen","selected","key","key2","optionId","Data","placeholder","controlName","form","show"],["mat-cell","",2,"width","20%",3,"click"],[1,"flex","resp-mode","trim_name","username"],[1,"show_in_resp"],[1,"username-col"],["size","medium","nbTooltipAdjustment","noop",1,"user-table",3,"name","color","initialColor","nbTooltip"],["class","employee-label",3,"click",4,"ngIf"],[1,"tags-container",3,"click"],[4,"ngFor","ngForOf"],["class","tags",3,"background-color",4,"ngIf"],[1,"employee-label",3,"click"],[1,"fa-solid","fa-user-tag","user-tag"],[1,"tags"],[3,"label","isFiltered","onClose","onApply","onClear","onOpen",4,"ngIf"],["mat-cell","",2,"width","20%"],[1,"resp-view"],[1,"truncate-name"],[4,"ngIf"],["templateAll",""],["class","works_with_column","nbTooltipPlacement","top","nbTooltipTrigger","hover",3,"nbTooltip","mouseenter",4,"ngIf","ngIfElse"],["nbTooltipPlacement","top","nbTooltipTrigger","hover",1,"works_with_column",3,"nbTooltip","mouseenter"],["class","works_with_column",4,"ngIf","ngIfElse"],[1,"works_with_column"],[1,"all-stores"],["mat-header-cell","",1,"email-col",2,"width","20%","padding-left","38px !important"],["emailFilter",""],[3,"placeholder","controlName","form","keydown.enter"],["mat-cell","",1,"email-col",2,"width","20%"],[1,"flex","desktop-resend",2,"align-items","center"],["class","flex","style","align-items: center;",3,"class","click",4,"ngIf"],[1,"email_trim"],[1,"flex","resp-resend",2,"align-items","center"],["class","flex","style","align-items: center; margin-left: 4px;",3,"class","click",4,"ngIf"],[1,"flex",2,"align-items","center",3,"click"],["src","assets/resend-email1.png","alt","kindly resend pin","nbTooltip","Resend email invite.",1,"resend_image"],[1,"flex",2,"align-items","center","margin-left","4px",3,"click"],["mat-header-cell","",1,"phone-col",2,"width","20%"],["phoneFilter",""],["mat-cell","",1,"phone-col",2,"width","20%"],[1,"flex","resp-mode"],["class","relative pointer",3,"click",4,"ngIf"],[1,"phone_trim"],[1,"relative","pointer",3,"click"],["mat-cell","",1,"status_badge",2,"width","20%"],[3,"ngClass"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"showhim",3,"ngClass"]],template:function(t,n){1&t&&(e._UZ(0,"app-loader",0),e.YNc(1,je,14,26,"span",1),e.TgZ(2,"span",2),e.YNc(3,Ge,1,4,"mat-paginator",3),e.qZA(),e.YNc(4,On,27,9,"div",4)),2&t&&(e.Q6J("loading",n.loading),e.xp6(1),e.Q6J("ngIf",null==n.gs?null:n.gs.isRespMode),e.xp6(2),e.Q6J("ngIf",n.paginator),e.xp6(1),e.Q6J("ngIf",n.dataSource&&n.dataSource.data))},directives:[Ve.R,k.O5,Re.u,K.x,L.t,Qe.x,S.NW,T.BZ,T.w1,T.fO,T.ge,T.Dz,T.ev,G.k,h.jNv,k.sg,k.mk,T.as,T.XQ,T.nj,T.Gk,W.k,X.V],pipes:[k.OU,Ee.e,Ye.X],styles:["table[_ngcontent-%COMP%] {\n  width: 100%;\n}\n\n.status_badge[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\n  background: #eeeeee;\n  border-radius: 4px;\n  padding: 3px;\n  display: inline-block;\n  text-align: center;\n  min-width: 54px;\n}\n\n.status_badge[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%] {\n  background: #dcfef5 !important;\n  color: #00523ce0 !important;\n}\n\n.status_badge[_ngcontent-%COMP%]   span.pending[_ngcontent-%COMP%] {\n  background: #f2f2fd !important;\n  color: #6e689b !important;\n}\n\nth.mat-header-cell[_ngcontent-%COMP%]:last-of-type, td.mat-cell[_ngcontent-%COMP%]:last-of-type, td.mat-footer-cell[_ngcontent-%COMP%]:last-of-type {\n  text-align: left !important;\n}\n\n.resend_image[_ngcontent-%COMP%] {\n  top: 0px;\n  position: relative;\n  left: -3px;\n  cursor: pointer;\n}\n\n.relative[_ngcontent-%COMP%] {\n  position: relative;\n}\n\n.email_trim[_ngcontent-%COMP%] {\n  max-width: 200px !important;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: inline-block;\n  margin-top: 5px;\n  align-items: center;\n}\n\n.phone_trim[_ngcontent-%COMP%] {\n  max-width: 150px !important;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: inline-block;\n  margin-top: 5px;\n  align-items: center;\n}\n\n@media (max-width: 724px) {\n  .view_resp_org[_ngcontent-%COMP%]   .resp_org_table[_ngcontent-%COMP%]   td.mat-cell[_ngcontent-%COMP%] {\n    background: #ffffff !important;\n  }\n}\n\n@media (max-width: 991px) and (min-width: 931px) {\n  .view_resp_org[_ngcontent-%COMP%] {\n    left: 17px;\n  }\n}\n\n@media (max-width: 1100px) and (min-width: 931px) {\n  .user-detail[_ngcontent-%COMP%]   .view_resp_org[_ngcontent-%COMP%] {\n    top: 29px;\n  }\n}\n\n.hide-active-email[_ngcontent-%COMP%] {\n  visibility: hidden;\n}\n\n@media (max-width: 931px) {\n  .resp-resend[_ngcontent-%COMP%] {\n    display: flex;\n  }\n\n  .desktop-resend[_ngcontent-%COMP%] {\n    display: none;\n  }\n}\n\n@media (min-width: 931px) {\n  .resp-resend[_ngcontent-%COMP%] {\n    display: none;\n  }\n\n  .desktop-resend[_ngcontent-%COMP%] {\n    display: flex;\n  }\n}\n\n.all-stores[_ngcontent-%COMP%] {\n  background: #dcfef5 !important;\n  color: #00523ce0 !important;\n  border-radius: 4px;\n  padding: 3px;\n  display: inline-block;\n  text-align: center;\n  min-width: 54px;\n  padding-right: 10px;\n  padding-left: 10px;\n}\n\n@media (max-width: 930px) {\n  .resp-mode[_ngcontent-%COMP%] {\n    align-items: baseline;\n  }\n}\n\n@media (min-width: 931px) {\n  .filters-wrapper[_ngcontent-%COMP%] {\n    display: none;\n  }\n}\n\n@media (max-width: 930px) {\n  .filters-wrapper[_ngcontent-%COMP%] {\n    display: flex;\n    margin-top: 0px;\n    color: #6e689b;\n    position: sticky;\n    top: 103px;\n    top: 76px;\n    z-index: 1;\n    background: #f9faff;\n    padding: 10px 4px !important;\n  }\n}\n\n.email-filter[_ngcontent-%COMP%] {\n  margin-left: 15px;\n}\n\n.phone-filter[_ngcontent-%COMP%] {\n  margin-left: 15px;\n}\n\n.username[_ngcontent-%COMP%] {\n  position: relative;\n}\n\n.employee-label[_ngcontent-%COMP%] {\n  position: absolute;\n  left: 37px;\n  top: 28px;\n  display: flex;\n  font-size: 12px;\n  display: none;\n}\n\n@media (max-width: 930px) {\n  .employee-label[_ngcontent-%COMP%] {\n    left: 147px;\n    top: 33px;\n  }\n}\n\n.user-tag[_ngcontent-%COMP%] {\n  color: #B0C4DE;\n  font-size: 11px;\n  margin-right: 3px;\n}\n\n.employee-label[_ngcontent-%COMP%]:hover {\n  text-decoration: underline;\n}\n\n.tags-container[_ngcontent-%COMP%] {\n  margin-left: 38px;\n  display: block;\n  margin-top: -10px;\n  font-size: 12px;\n}\n\n.tags[_ngcontent-%COMP%] {\n  padding: 1px;\n  padding-left: 8px;\n  padding-right: 8px;\n  border-radius: 10px;\n  margin-right: 5px;\n  display: inline-block;\n  margin-bottom: 5px;\n  color: #060606;\n}\n\n.username-col[_ngcontent-%COMP%] {\n  margin-bottom: 9px;\n}\n\n.tags[_ngcontent-%COMP%]:hover {\n  box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;\n  font-weight: 600;\n}"]}),o}(),H=u(4605),Pn=u(8258),N=u(149),In=u(7423);function Sn(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"nb-checkbox",12),e.NdJ("checkedChange",function(a){e.CHM(t);var r=e.oxw(2).$implicit;return e.oxw().todoItemSelectionToggle(a,r)}),e._uU(1),e.qZA()}if(2&o){var n=e.oxw(2).$implicit;e.Q6J("checked",n.selected),e.xp6(1),e.Oqu(n.name)}}function qn(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"span"),e._uU(1),e.TgZ(2,"span",13),e.NdJ("click",function(){e.CHM(t);var a=e.oxw(2).$implicit;return e.oxw().todoItemRemove(a)}),e.qZA(),e.qZA()}if(2&o){var n=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",n.name," ")}}function Nn(o,s){if(1&o&&(e.TgZ(0,"li",8),e._UZ(1,"button",9),e.YNc(2,Sn,2,2,"nb-checkbox",10),e.YNc(3,qn,3,1,"span",11),e.qZA()),2&o){var t=e.oxw(2);e.xp6(2),e.Q6J("ngIf","select"===t.type),e.xp6(1),e.Q6J("ngIf","display"===t.type)}}function Dn(o,s){if(1&o&&(e.TgZ(0,"mat-tree-node",6),e.YNc(1,Nn,4,2,"li",7),e.qZA()),2&o){var t=s.$implicit;e.xp6(1),e.Q6J("ngIf",!t.removed)}}function Fn(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"nb-checkbox",20),e.NdJ("checkedChange",function(a){e.CHM(t);var r=e.oxw(2).$implicit;return e.oxw().todoItemSelectionToggle(a,r)}),e._uU(1),e.qZA()}if(2&o){var n=e.oxw(2).$implicit;e.Q6J("checked",n.selected)("indeterminate",n.indeterminate&&!n.selected),e.xp6(1),e.hij(" ",n.name," ")}}function Jn(o,s){if(1&o){var t=e.EpF();e.TgZ(0,"span"),e._uU(1),e.TgZ(2,"span",13),e.NdJ("click",function(){e.CHM(t);var a=e.oxw(2).$implicit;return e.oxw().todoItemRemove(a)}),e.qZA(),e.qZA()}if(2&o){var n=e.oxw(2).$implicit;e.xp6(1),e.hij("",n.name," ")}}var Vn=function(s,t){return{"fa-chevron-down":s,"fa-chevron-right":t}};function Rn(o,s){if(1&o&&(e.TgZ(0,"li"),e.TgZ(1,"div",8),e.TgZ(2,"span",14),e.TgZ(3,"button",15),e._UZ(4,"i",16),e.qZA(),e.qZA(),e.YNc(5,Fn,2,3,"nb-checkbox",17),e.TgZ(6,"span",18),e.TgZ(7,"nb-checkbox"),e._uU(8," Select region only "),e.qZA(),e.qZA(),e.YNc(9,Jn,3,1,"span",11),e.qZA(),e.TgZ(10,"ul"),e.GkF(11,19),e.qZA(),e.qZA()),2&o){var t=e.oxw().$implicit,n=e.oxw();e.xp6(3),e.uIk("aria-label","toggle "+t.name),e.xp6(1),e.Q6J("ngClass",e.WLB(6,Vn,n.treeControl.isExpanded(t),!n.treeControl.isExpanded(t))),e.xp6(1),e.Q6J("ngIf","select"===n.type),e.xp6(4),e.Q6J("ngIf","display"===n.type),e.xp6(1),e.ekj("example-tree-invisible",!n.treeControl.isExpanded(t))}}function Qn(o,s){if(1&o&&(e.TgZ(0,"mat-nested-tree-node"),e.YNc(1,Rn,12,9,"li",11),e.qZA()),2&o){var t=s.$implicit;e.xp6(1),e.Q6J("ngIf",!t.removed)}}var En=function(){var o=function(){function s(){(0,O.Z)(this,s),this.changeClick=new e.vpe,this.treeControl=new Pn.VY(function(t){return t.children}),this.dataSource=new N.WX,this.hasChild=function(t,n){return!!n.children&&n.children.length>0}}return(0,M.Z)(s,[{key:"ngOnInit",value:function(){this.dataSource.data=this.data}},{key:"ngOnChanges",value:function(n){var i=this;n.data&&void 0!==n.data.currentValue&&(null==n.data.currentValue?this.dataSource.data=null:(this.dataSource.data=n.data.currentValue,Object.keys(this.dataSource.data).forEach(function(a){i.setParent(i.dataSource.data[a],null),i.dataSource.data[a].indeterminate=i.dataSource.data[a].children.some(function(r){return r.selected})}))),n.mode&&void 0!==n.mode.currentValue&&(this.mode=n.mode.currentValue)}},{key:"setParent",value:function(n,i){var a=this;n.parent=i,n.children&&n.children.forEach(function(r){a.setParent(r,n)})}},{key:"checkAllParents",value:function(n){if(n.parent){var i=this.treeControl.getDescendants(n.parent);n.parent.selected=i.every(function(a){return a.selected}),n.parent.indeterminate=i.some(function(a){return a.selected}),this.checkAllParents(n.parent)}}},{key:"todoItemSelectionToggle",value:function(n,i){var a=this;i.selected=n,i.children&&i.children.forEach(function(r){a.todoItemSelectionToggle(n,r)}),this.checkAllParents(i)}},{key:"removeAllParents",value:function(n){if(n.parent){var i=this.treeControl.getDescendants(n.parent);n.parent.removed=i.every(function(a){return a.removed}),this.removeAllParents(n.parent)}}},{key:"todoItemRemove",value:function(n){var i=this;n.removed=!0,n.children&&n.children.forEach(function(a){i.todoItemRemove(a)}),this.removeAllParents(n)}},{key:"submit",value:function(){var n=this;if("display"!==this.type){var i=[];this.dataSource.data.forEach(function(a){var r=[];(r=r.concat(n.treeControl.getDescendants(a).filter(function(p){return p.selected&&p.id}).map(function(p){return{name:p.name,id:p.id}}))).length>0?i.push({name:a.name,id:a.id,selected:a.selected,children:r}):a.selected&&i.push({name:a.name,id:a.id,selected:a.selected,children:a.children})}),setTimeout(function(){n.changeClick.emit(i)},1e3)}}}]),s}();return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-nested-table"]],inputs:{type:"type",mode:"mode",data:"data"},outputs:{changeClick:"changeClick"},features:[e.TTD],decls:7,vars:4,consts:[[2,"max-height","65vh","overflow","auto"],[1,"example-tree",3,"dataSource","treeControl"],["matTreeNodeToggle","",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],[1,"footer_buttons"],["size","medium","nbButton","","status","primary",3,"click"],["matTreeNodeToggle",""],["class","mat-tree-node",4,"ngIf"],[1,"mat-tree-node"],["size","medium","type","button","mat-icon-button","","disabled",""],["class","checklist-leaf-node",3,"checked","checkedChange",4,"ngIf"],[4,"ngIf"],[1,"checklist-leaf-node",3,"checked","checkedChange"],[3,"click"],[1,""],["size","medium","type","button","mat-icon-button","","matTreeNodeToggle",""],[1,"fas",3,"ngClass"],[3,"checked","indeterminate","checkedChange",4,"ngIf"],[1,"region_only",2,"display","none"],["matTreeNodeOutlet",""],[3,"checked","indeterminate","checkedChange"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"mat-tree",1),e.YNc(2,Dn,2,1,"mat-tree-node",2),e.YNc(3,Qn,2,1,"mat-nested-tree-node",3),e.qZA(),e.qZA(),e.TgZ(4,"div",4),e.TgZ(5,"button",5),e.NdJ("click",function(){return n.submit()}),e._uU(6),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("dataSource",n.dataSource)("treeControl",n.treeControl),e.xp6(2),e.Q6J("matTreeNodeDefWhen",n.hasChild),e.xp6(3),e.Oqu("display"===n.type?n.mode:"Done"))},directives:[N.gi,N.fQ,N.uo,N.eu,k.O5,In.lW,h.NTf,N.GZ,k.mk,N.Ar,h.DPz],styles:[".example-tree-invisible[_ngcontent-%COMP%] {\n  display: none;\n}\n\n.example-tree[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .example-tree[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] {\n  margin-top: 0;\n  margin-bottom: 0;\n  list-style-type: none;\n}\n\n.mat-icon-button[_ngcontent-%COMP%] {\n  margin: 4px;\n  background: #f7f7f7;\n}\n\n.footer_buttons[_ngcontent-%COMP%] {\n  justify-content: flex-end;\n  width: 100%;\n  display: flex;\n  margin-top: 0px;\n}\n\n.mat-tree-node[_ngcontent-%COMP%] {\n  background: #f7f7f7;\n  margin-bottom: 2px;\n}\n\n.example-tree[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] {\n  margin-top: 0;\n  margin-bottom: 20px;\n  list-style-type: none;\n  background: #f7f7f7;\n}\n\ni.fas.fa-times-circle[_ngcontent-%COMP%] {\n  position: absolute;\n  right: 40px;\n  font-size: 15px;\n  margin-top: 2px;\n  color: #ff3d71;\n}\n\n.region_only[_ngcontent-%COMP%] {\n  position: absolute;\n  right: 30px;\n}"]}),o}(),Yn=function(){var o=function(){function s(t){(0,O.Z)(this,s),this.service=t,this.assignmentChange=new e.vpe}return(0,M.Z)(s,[{key:"ngOnInit",value:function(){this.assignmentData?this.treeData=this.assignmentData:this.getData()}},{key:"ngOnChanges",value:function(n){n.assignmentData&&n.assignmentData.currentValue&&(this.treeData=n.assignmentData.currentValue),n.refreshData&&n.refreshData.currentValue!==n.refreshData.previousValue&&this.getData()}},{key:"getData",value:function(){var n,i;return(0,I.mG)(this,void 0,void 0,y().mark(function a(){return y().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.prev=0,p.next=3,this.service.getRegions(this.searchText);case 3:this.treeData=p.sent,this.emptySearchResults=!(0!==(null===(n=this.treeData)||void 0===n?void 0:n.length)||!this.searchText),this.emptyResults=0===(null===(i=this.treeData)||void 0===i?void 0:i.length)&&!this.searchText,p.next=11;break;case 8:p.prev=8,p.t0=p.catch(0),console.log(p.t0);case 11:case"end":return p.stop()}},a,this,[[0,8]])}))}},{key:"onAssignment",value:function(n){this.assignmentChange.emit(n)}},{key:"onSearch",value:function(n){this.searchText=n.trim(),this.getData()}},{key:"clearSearchField",value:function(){this.searchField.clear()}}]),s}();return o.\u0275fac=function(t){return new(t||o)(e.Y36(F.K))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-assign-region-teams"]],viewQuery:function(t,n){var i;1&t&&e.Gf(H.J,5),2&t&&e.iGM(i=e.CRH())&&(n.searchField=i.first)},inputs:{nameConfig:"nameConfig",refreshData:"refreshData",assignmentData:"assignmentData"},outputs:{assignmentChange:"assignmentChange"},features:[e.TTD],decls:8,vars:7,consts:[[1,"assing_second_drawer"],[1,"title"],[3,"showHelperButton","searchEvent"],[3,"display"],[1,"mt_10"],[3,"type","data","changeClick"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"b",1),e._uU(2),e.qZA(),e.TgZ(3,"app-search-input",2),e.NdJ("searchEvent",function(a){return n.onSearch(a)}),e.qZA(),e._UZ(4,"app-no-records",3),e._UZ(5,"app-no-search-records",3),e.TgZ(6,"div",4),e.TgZ(7,"app-nested-table",5),e.NdJ("changeClick",function(a){return n.onAssignment(a)}),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.AsE("Assign ",null==n.nameConfig?null:n.nameConfig.region_plural," & ",null==n.nameConfig?null:n.nameConfig.team_plural,""),e.xp6(1),e.Q6J("showHelperButton",!1),e.xp6(1),e.Q6J("display",n.emptyResults),e.xp6(1),e.Q6J("display",!n.emptyResults&&n.emptySearchResults),e.xp6(2),e.Q6J("type","select")("data",n.treeData))},directives:[H.J,W.k,X.V,En],styles:[""]}),o}(),Hn=function(){var o=function(){function s(t,n){(0,O.Z)(this,s),this.dataService=t,this.ref=n}return(0,M.Z)(s,[{key:"ngOnInit",value:function(){var n=this;this.dataService.getConfigurations(!1).then(function(i){var a;n.nameConfig=null===(a=i.company)||void 0===a?void 0:a.custom_names}).finally(function(){})}},{key:"close",value:function(n){this.ref.close(n)}}]),s}();return o.\u0275fac=function(t){return new(t||o)(e.Y36(q.s),e.Y36(h.X4l))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-view-template"]],decls:37,vars:6,consts:[[1,"modal_wrapper","import_modal"],[1,"card_header"],[1,"title",2,"text-align","center","margin","5px"],["icon","close",1,"cross_icon","hidden",3,"click"],[1,"instructions-list"],["src","assets/templ.PNG","alt","image to view excel template"],[1,"footer_button",2,"justify-content","flex-end","margin-top","15px !important"],[3,"onClick"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"nb-card"),e.TgZ(2,"nb-card-header",1),e.TgZ(3,"label"),e.TgZ(4,"b",2),e._uU(5,"Instructions for Import File"),e.qZA(),e.qZA(),e.TgZ(6,"nb-icon",3),e.NdJ("click",function(){return n.close(null)}),e.qZA(),e.qZA(),e.TgZ(7,"nb-card-body"),e.TgZ(8,"ul"),e.TgZ(9,"li",4),e._uU(10," The format of the file must be .xlsx. "),e.qZA(),e.TgZ(11,"li",4),e._uU(12," Following columns must be included in the file: Name, Email, Phone, PIN, Role and Store. "),e.qZA(),e.TgZ(13,"li",4),e._uU(14," Email addresses and phone numbers have to be "),e.TgZ(15,"b"),e._uU(16,"unique"),e.qZA(),e._uU(17,", as these will be used to send "),e.TgZ(18,"b"),e._uU(19,"invitation"),e.qZA(),e._uU(20," links to the users. "),e.qZA(),e.TgZ(21,"li",4),e._uU(22," PIN is the only optional column. It is used to login the mobile application. If PIN is entered, it will be sent via text message. If it is not entered for a user, then a random "),e.TgZ(23,"b"),e._uU(24,"4-digits PIN"),e.qZA(),e._uU(25," will be sent. "),e.qZA(),e.TgZ(26,"li",4),e._uU(27),e.ALo(28,"lowercase"),e.TgZ(29,"b"),e._uU(30,"Store"),e.qZA(),e._uU(31),e.ALo(32,"lowercase"),e.qZA(),e._UZ(33,"img",5),e.qZA(),e.TgZ(34,"div",6),e.TgZ(35,"app-button",7),e.NdJ("onClick",function(){return n.close(null)}),e._uU(36,"Cancel"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(27),e.hij(" The added user must exist in at least one ",e.lcZ(28,2,null==n.nameConfig?null:n.nameConfig.region),". In the "),e.xp6(4),e.hij(" column, specify the ",e.lcZ(32,4,null==n.nameConfig?null:n.nameConfig.region_plural)," in which the user works in, separating them with a semicolon(;). "))},directives:[h.Asz,h.ndF,h.fMN,h.yKW,Q.r],pipes:[k.i8],styles:['@charset "UTF-8";\n.modal_wrapper[_ngcontent-%COMP%] {\n  width: 60% !important;\n  margin: 0px auto !important;\n}\n.modal_wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n  margin: 0px auto;\n  display: block;\n  margin-top: 10px;\n  width: 95% !important;\n}\n@media (min-width: 931px) {\n  .modal_wrapper[_ngcontent-%COMP%] {\n    width: 50% !important;\n    margin: 0px auto !important;\n  }\n}\n@media (max-width: 930px) and (min-width: 606px) {\n  .import_modal[_ngcontent-%COMP%] {\n    width: 590px !important;\n  }\n}\n@media (max-width: 605px) and (max-width: 500px) {\n  .import_modal[_ngcontent-%COMP%] {\n    width: 75% !important;\n  }\n\n  img[_ngcontent-%COMP%] {\n    display: none !important;\n  }\n}\n@media (max-width: 499px) and (max-width: 450px) {\n  .import_modal[_ngcontent-%COMP%] {\n    width: 317px !important;\n    overflow: auto;\n  }\n\n  img[_ngcontent-%COMP%] {\n    display: none !important;\n  }\n}\n@media (max-width: 449px) and (max-width: 400px) {\n  .import_modal[_ngcontent-%COMP%] {\n    width: 360px !important;\n    overflow: auto;\n  }\n\n  img[_ngcontent-%COMP%] {\n    display: none !important;\n  }\n}\n@media (max-width: 399px) and (max-width: 320px) {\n  .import_modal[_ngcontent-%COMP%] {\n    width: 300px !important;\n    overflow: auto;\n  }\n\n  img[_ngcontent-%COMP%] {\n    display: none !important;\n  }\n}\n.import_modal[_ngcontent-%COMP%]   nb-card-header[_ngcontent-%COMP%] {\n  background: #7b68ee;\n  border-top-left-radius: 10px;\n  border-top-right-radius: 10px;\n}\n.import_modal[_ngcontent-%COMP%]   nb-card-header[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {\n  color: white;\n}\nul[_ngcontent-%COMP%] {\n  list-style: none;\n}\n.instructions-list[_ngcontent-%COMP%] {\n  line-height: 1.5;\n  padding-bottom: 8px;\n}\nul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]::before {\n  content: "\u2022";\n  color: #5d5ddb;\n  font-weight: bold;\n  display: inline-block;\n  width: 1em;\n  margin-left: -1.3em;\n}']}),o}(),zn=u(1198),Bn=["ngForm"],Ln=["fileUpload"];function $n(o,s){1&o&&(e.TgZ(0,"div",22),e._uU(1,"Invalid file type."),e.qZA())}function jn(o,s){if(1&o&&(e.ynx(0),e.YNc(1,$n,2,0,"div",21),e.BQk()),2&o){var t=e.oxw(),n=e.MAs(15);e.xp6(1),e.Q6J("ngIf",n.submitted&&(null==t.UploadFileForm.errors?null:t.UploadFileForm.errors.invalidFileType))}}var ne=function(){var o=function(){function s(t,n,i,a,r,p){var l=this;(0,O.Z)(this,s),this.ref=t,this.fb=n,this.dialogService=i,this.service=a,this.gs=r,this.analytics=p,this.fileData=null,this.loading=!1,this.formSuccess=new e.vpe,this.addFormValues=function(){l.UploadFileForm=l.fb.group({file:["",d.kI.required]},{validator:[l.fileValidator]})},this.fileValidator=function(m){var _={};if(l.fileName=m.controls.file.value,l.fileName){var v=m.controls.file.value.split(".");"xlsx"!==v[v.length-1]&&(_={invalidFileType:!0})}return _==={}?null:_},this.resetForm=function(){l.UploadFileForm.reset(l.UploadFileForm),l.fileData=null,l.ngForm.resetForm(),l.fileUpload.nativeElement.value=null},this.submit=function(m){return(0,I.mG)(l,void 0,void 0,y().mark(function _(){var c,v;return y().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.analytics.logEvents("upload_users_data"),!m.valid){g.next=20;break}return this.loading=!0,(c=new FormData).append("users",this.fileData,this.fileData.name),g.prev=5,g.next=8,this.service.importUsers(c);case 8:this.gs.showToastSuccess(null==(v=g.sent)?void 0:v.message),this.close(!0),g.next=17;break;case 13:g.prev=13,g.t0=g.catch(5),this.gs.showToastError(g.t0.message),"Errors in file uploaded!"===g.t0.message&&this.open("viewErrors",g.t0);case 17:return g.prev=17,this.loading=!1,g.finish(17);case 20:case"end":return g.stop()}},_,this,[[5,13,17,20]])}))},this.handleFileInput=function(m){l.fileData=m.target.files[0],l.UploadFileForm.controls.file.setValue(l.fileData.name)},this.clickSelectFile=function(){l.fileUpload.nativeElement.click()},this.temp={viewTemp:Hn,viewErrors:zn.y}}return(0,M.Z)(s,[{key:"ngOnInit",value:function(){this.addFormValues()}},{key:"open",value:function(n){var i=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.analytics.logEvents("users_template"),this.dialogService.open(this.temp[n],{hasBackdrop:!0,closeOnBackdropClick:!1,context:{data:a}}).onClose.subscribe(function(r){i.resetForm()})}},{key:"close",value:function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.ref.close(n)}}]),s}();return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.X4l),e.Y36(d.qu),e.Y36(h.Gln),e.Y36(F.K),e.Y36(D.m),e.Y36(R.C))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-import-users"]],viewQuery:function(t,n){var i;1&t&&(e.Gf(Bn,5),e.Gf(Ln,5)),2&t&&(e.iGM(i=e.CRH())&&(n.ngForm=i.first),e.iGM(i=e.CRH())&&(n.fileUpload=i.first))},outputs:{formSuccess:"formSuccess"},decls:37,vars:7,consts:[[1,"modal_wrapper","import-users"],[1,"card_header"],[1,"title"],["icon","close",1,"cross_icon","hidden",3,"click"],[3,"nbSpinner"],[1,"templete_wrapper","flex","space_between"],[1,"link_button",2,"font-size","13px"],[3,"click"],["id","form",3,"formGroup","ngSubmit"],["ngForm","ngForm"],[1,"upload_file","cetner"],[1,""],["size","medium","type","button","id","filebutton","outline","","nbButton","","status","primary",1,"excel-btn",3,"click"],["aria-hidden","true",1,"fas","fa-2x","fa-file-excel"],["type","file","aria-label","choose file button","accept",".xlsx","hidden","",3,"change"],["fileUpload",""],[3,"key","form","isSubmitted"],[4,"ngIf"],[1,"footer_button",2,"justify-content","flex-end","margin-top","15px !important"],[3,"onClick"],["size","medium","type","submit","nbButton","","status","primary"],["class","red","style","font-size: 13px;",4,"ngIf"],[1,"red",2,"font-size","13px"]],template:function(t,n){if(1&t){var i=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"nb-card"),e.TgZ(2,"nb-card-header",1),e.TgZ(3,"label"),e.TgZ(4,"b",2),e._uU(5,"Import Users"),e.qZA(),e.qZA(),e.TgZ(6,"nb-icon",3),e.NdJ("click",function(){return n.close()}),e.qZA(),e.qZA(),e.TgZ(7,"nb-card-body",4),e.TgZ(8,"div",5),e.TgZ(9,"div",6),e._uU(10,"You can add users to the system by uploading an excel file. Please "),e.TgZ(11,"a",7),e.NdJ("click",function(){return n.open("viewTemp")}),e._uU(12,"click here"),e.qZA(),e._uU(13," to view the template file containing instructions on how the data should be arranged in an excel."),e.qZA(),e.qZA(),e.TgZ(14,"form",8,9),e.NdJ("ngSubmit",function(){e.CHM(i);var p=e.MAs(15);return n.submit(p)}),e.TgZ(16,"div",10),e.TgZ(17,"b",11),e._uU(18,"Select a file to import"),e._UZ(19,"br"),e.qZA(),e._UZ(20,"br"),e.TgZ(21,"button",12),e.NdJ("click",function(){return n.clickSelectFile()}),e._UZ(22,"i",13),e._uU(23," Choose File"),e.qZA(),e._UZ(24,"br"),e.TgZ(25,"input",14,15),e.NdJ("change",function(p){return n.handleFileInput(p)}),e.qZA(),e._UZ(27,"br"),e._uU(28),e.qZA(),e._UZ(29,"br"),e._UZ(30,"app-error-message",16),e.YNc(31,jn,2,1,"ng-container",17),e.TgZ(32,"div",18),e.TgZ(33,"app-button",19),e.NdJ("onClick",function(){return n.close()}),e._uU(34,"Cancel"),e.qZA(),e.TgZ(35,"button",20),e._uU(36,"Upload"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&t){var a=e.MAs(15);e.xp6(7),e.Q6J("nbSpinner",n.loading),e.xp6(7),e.Q6J("formGroup",n.UploadFileForm),e.xp6(14),e.hij(" ",n.fileName," "),e.xp6(2),e.Q6J("key","file")("form",n.UploadFileForm)("isSubmitted",a.submitted),e.xp6(1),e.Q6J("ngIf",!n.UploadFileForm.controls.file.errors)}},directives:[h.Asz,h.ndF,h.fMN,h.yKW,h.Q7R,d._Y,d.JL,d.sg,A.w5,h.DPz,A.Yi,A.A3,B.H,k.O5,Q.r],styles:[".templete_wrapper[_ngcontent-%COMP%] {\n  background: #f9f9f9;\n  border-radius: 5px;\n}\n\n.upload_file.cetner[_ngcontent-%COMP%] {\n  margin-top: 21px;\n  padding-left: 45px;\n  padding-right: 45px;\n  padding-top: 25px;\n  padding-bottom: 25px;\n  text-align: center;\n  background: #f9f7ff;\n  font-size: 13px;\n}\n\ni.fas.fa-2x.fa-file-excel[_ngcontent-%COMP%] {\n  color: #00bd8b;\n  padding-right: 10px;\n}\n\n.underline[_ngcontent-%COMP%] {\n  text-decoration: underline;\n  cursor: pointer;\n}\n\n.title[_ngcontent-%COMP%] {\n  display: contents;\n}\n\n.excel-btn[_ngcontent-%COMP%] {\n  background-color: white !important;\n  color: #7b68ee !important;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.02), 0 1px 3px rgba(0, 0, 0, 0.14);\n  text-transform: capitalize;\n  font-size: 13px;\n}"]}),o}(),Kn=[{path:"",component:function(){var o=function(){function s(t,n,i,a,r,p,l,m){(0,O.Z)(this,s),this.route=t,this.dataService=n,this.router=i,this.gs=a,this.cdRef=r,this.nbMenuService=p,this.dialogService=l,this.analytics=m,this.sidebarOpened=!1,this.resetAddUserFormToggle=!1}return(0,M.Z)(s,[{key:"ngOnInit",value:function(){var n=this;setTimeout(function(){n.selectedTab="all_users",n.gs.logEvents(n.selectedTab+"_tab")},2),this.openAddView=!1,this.isAddAnotherRegion=!1,this.roleId=null,this.regionId=null,this.showFilterResponsive=!1,this.dataService.getConfigurations(!1).then(function(i){var a,r,p;(null===(r=null===(a=i.role.modules)||void 0===a?void 0:a.OrganisationManagement)||void 0===r?void 0:r.enabled)||n.router.navigate(["401"]),(2===i.role.role_id||i.role.role_title.includes("Account Owner"))&&(n.isAccountOwner=!0),n.nameConfig=null===(p=i.company)||void 0===p?void 0:p.custom_names}).finally(function(){}),this.route.queryParamMap.subscribe(function(i){}),this.gs.hideSplashScreen(),this.gs.showBackDrop(!1),this.menuItems=[{title:"Add New",data:{id:1}},{title:"Import Excel",data:{id:2}}],this.checked=!0,this.refreshData=!1,this.nbMenuService.onItemClick().subscribe(function(i){})}},{key:"showImport",value:function(){var n=this;this.dialogService.open(ne,{hasBackdrop:!0,closeOnBackdropClick:!1}).onClose.subscribe(function(i){i&&(n.UserTableViewComponentInstance.getData(),n.refreshData=!n.refreshData)})}},{key:"showUser",value:function(){var n=this;this.dialogService.open(Y,{hasBackdrop:!0,closeOnBackdropClick:!1,context:{openAddView:this.openAddView,roleId:this.roleId,regionId:this.regionId}}).onClose.subscribe(function(i){i.refresh?(n.UserTableViewComponentInstance.getAllUsersCount(),n.openAddView=!1,n.roleId=null,n.regionId=null,n.UserTableViewComponentInstance.getData()):!i.refresh&&i.createAnother?(n.roleId=i.roleId,n.regionId=i.regionId,n.openAddView=!0,n.UserTableViewComponentInstance.getData(),n.UserTableViewComponentInstance.getAllUsersCount(),n.showUser()):(n.openAddView=!1,n.roleId=null,n.regionId=null)})}},{key:"totalReceived",value:function(n){this.total=n}},{key:"ngAfterViewChecked",value:function(){this.cdRef.detectChanges()}},{key:"temp",value:function(n){}},{key:"onSearch",value:function(n){this.gs.logEvents("search_organisation_page"),this.searchOn=n.trim()}},{key:"onSearchAll",value:function(n){this.searchOn=n.trim()}},{key:"callRegionHierarchy",value:function(){this.hierarchyCall=!this.hierarchyCall}},{key:"toggleAnalytics",value:function(){this.analytics.logEvents("toggle_users")}},{key:"setTab",value:function(n){this.selectedTab=n,this.gs.logEvents(this.selectedTab+"_tab")}}]),s}();return o.\u0275fac=function(t){return new(t||o)(e.Y36(f.gz),e.Y36(q.s),e.Y36(f.F0),e.Y36(D.m),e.Y36(e.sBO),e.Y36(h.kkI),e.Y36(h.Gln),e.Y36(R.C))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-user-page"]],viewQuery:function(t,n){var i;1&t&&(e.Gf(ee,5),e.Gf(Yn,5),e.Gf(Y,5),e.Gf(ne,5)),2&t&&(e.iGM(i=e.CRH())&&(n.UserTableViewComponentInstance=i.first),e.iGM(i=e.CRH())&&(n.AssignRegionTeamsInstance=i.first),e.iGM(i=e.CRH())&&(n.AddUserComponentInstance=i.first),e.iGM(i=e.CRH())&&(n.ImportUsersComponentInstance=i.first))},features:[e._Bn([h.lzT])],decls:22,vars:10,consts:[[1,"flex","add-store-link"],[1,"colored-column-info","timesheets_wrapper","organization-module"],[1,"wrapper_header","mb_10"],[1,"flex","vertical_center_org","search_input_fix"],[1,"toggle_buttons","mr_10"],["nbButton","","value","all_users","size","medium",3,"status","click"],["nbButton","","value","active_users","size","medium",3,"status","click"],["nbButton","","value","pending_users","size","medium",3,"status","click"],[1,"search","resp-search"],[3,"placeholder","showHelperButton","searchEvent","searchAll"],[1,"import-users","desktopReport","exportReport","mr_10",3,"click"],["aria-hidden","true","nbTooltipAdjustment","noop","nbTooltip","Import users",1,"fas","fa-file-import"],["size","medium","type","submit","nbButton","","status","primary",3,"click"],[1,"org-view"],[3,"type","checked","searchText","selectedTab","filterData","totalUsers","callRegionHierarchy"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"nb-layout-column",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"span",4),e.TgZ(5,"nb-button-group"),e.TgZ(6,"button",5),e.NdJ("click",function(){return n.setTab("all_users")}),e._uU(7," All Users "),e.qZA(),e.TgZ(8,"button",6),e.NdJ("click",function(){return n.setTab("active_users")}),e._uU(9," Active "),e.qZA(),e.TgZ(10,"button",7),e.NdJ("click",function(){return n.setTab("pending_users")}),e._uU(11," Pending "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"span",8),e.TgZ(13,"app-search-input",9),e.NdJ("searchEvent",function(a){return n.onSearch(a)})("searchAll",function(a){return n.onSearchAll(a)}),e.qZA(),e.TgZ(14,"span",10),e.NdJ("click",function(){return n.showImport()}),e._UZ(15,"i",11),e.qZA(),e.TgZ(16,"span"),e.TgZ(17,"button",12),e.NdJ("click",function(){return n.showUser()}),e._uU(18,"Add User"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",13),e.TgZ(20,"app-user-table-view",14),e.NdJ("totalUsers",function(a){return n.totalReceived(a)})("callRegionHierarchy",function(){return n.callRegionHierarchy()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(21,"div")),2&t&&(e.xp6(6),e.Q6J("status","all_users"===n.selectedTab?"primary":""),e.xp6(2),e.Q6J("status","active_users"===n.selectedTab?"primary":""),e.xp6(2),e.Q6J("status","pending_users"===n.selectedTab?"primary":""),e.xp6(3),e.Q6J("placeholder","Search by name or role")("showHelperButton",n.showHelperButton),e.xp6(7),e.Q6J("type","user-detail")("checked",n.checked)("searchText",n.searchOn)("selectedTab",n.selectedTab)("filterData",n.filterOn))},directives:[h.dP_,h.mnu,h.DPz,H.J,h.jNv,ee],styles:[".timesheets_wrapper[_ngcontent-%COMP%]   .wrapper_header[_ngcontent-%COMP%] {\n  padding: 28px 0px;\n  padding-bottom: 31px;\n  top: 11px !important;\n  background: #f9faff;\n}\n\n@media (max-width: 930px) and (min-width: 520px) {\n  .timesheets_wrapper[_ngcontent-%COMP%]   .wrapper_header[_ngcontent-%COMP%] {\n    padding: 61px 10px !important;\n    padding-bottom: 15px !important;\n  }\n}\n\nnb-button-group.custom-css[_ngcontent-%COMP%] {\n  padding: 0px !important;\n}\n\nnb-button-group.custom-css2[_ngcontent-%COMP%] {\n  padding: 0px !important;\n}\n\n@media (max-width: 725px) and (min-width: 320px) {\n  .resp-search[_ngcontent-%COMP%] {\n    display: flex;\n    justify-content: flex-end;\n    margin-top: 20px;\n  }\n\n  .search_input_fix[_ngcontent-%COMP%] {\n    flex-direction: column;\n  }\n\n  .timesheets_wrapper[_ngcontent-%COMP%]   .wrapper_header[_ngcontent-%COMP%] {\n    padding: 93px 0px !important;\n    padding-bottom: 10px !important;\n    width: 108%;\n  }\n}\n\nnb-button-group[_ngcontent-%COMP%]   [nbButton].appearance-filled.status-primary[_ngcontent-%COMP%]:not(:first-child):not(:hover):not(:focus):not(:active):not([disabled]), [dir=ltr][_ngcontent-%COMP%]   nb-button-group[_ngcontent-%COMP%]   [nbButtonToggle].appearance-filled.status-primary[_ngcontent-%COMP%]:not(:first-child):not(:hover):not(:focus):not(:active):not([disabled]) {\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.02), 0 1px 3px rgba(0, 0, 0, 0.14);\n}\n\n.import-users[_ngcontent-%COMP%] {\n  background: #ffffff;\n  padding: 7px 9px;\n  border-radius: 10px;\n  color: #7b68ee !important;\n  cursor: pointer;\n  font-weight: 500;\n  border-radius: 2px;\n  min-width: 30px;\n  border-radius: 52%;\n  width: 32x;\n  height: 32px;\n  box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;\n  margin-left: 10px !important;\n}\n\n.resp-search[_ngcontent-%COMP%] {\n  display: inline-flex;\n}\n\n@media (min-width: 1000px) {\n  .add-store-link[_ngcontent-%COMP%] {\n    flex-direction: column;\n  }\n}\n\n@media (max-width: 999px) {\n  .add-store-link[_ngcontent-%COMP%] {\n    flex-direction: column;\n  }\n}"]}),o}()}],Wn=function(){var o=(0,M.Z)(function s(){(0,O.Z)(this,s)});return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[f.Bz.forChild(Kn)],f.Bz]}),o}(),Xn=u(5032),et=function(){var o=(0,M.Z)(function s(){(0,O.Z)(this,s)});return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[k.ez,Xn.m,Wn]]}),o}()},3963:function(te,J,u){u.d(J,{x:function(){return e}});var M=u(5671),O=u(3144),f=u(5e3),h=u(9808),V=u(4825);function y(T,S){if(1&T){var x=f.EpF();f.TgZ(0,"span",2),f.NdJ("click",function(){return f.CHM(x),f.oxw().toggleSort()}),f._uU(1),f._UZ(2,"i",3),f.qZA()}if(2&T){var d=f.oxw();f.Tol(d.isSelected?"sort-selected":""),f.xp6(1),f.hij(" ",d.label," "),f.xp6(1),f.Tol(d.isAscending?d.ascendingClass:d.descendingClass)}}function I(T,S){if(1&T){var x=f.EpF();f.TgZ(0,"span"),f.TgZ(1,"button",4),f.NdJ("click",function(){return f.CHM(x),f.oxw().toggleSort()}),f._UZ(2,"i",5),f._uU(3,"Sort"),f.qZA(),f.qZA()}}var e=function(){var T=function(){function S(){(0,M.Z)(this,S),this.onSort=new f.vpe,this.icons={number:{ascending:"fas fa-arrow-down-1-9",descending:"fas fa-arrow-down-9-1"},alpha:{ascending:"fas fa-arrow-down-a-z",descending:"fas fa-arrow-down-z-a"}},this.label=this.label?this.label:"",this.iconType=this.iconType?this.iconType:"alpha",this.isSelected=!!this.isSelected&&this.isSelected}return(0,O.Z)(S,[{key:"ngOnInit",value:function(){this.isAscending=!0,this.order=this.order?this.order:1,this.isAscending=this.order>0,this.ascendingClass=this.icons[this.iconType].ascending,this.descendingClass=this.icons[this.iconType].descending}},{key:"ngOnChanges",value:function(d){d.isSelected&&d.isSelected.currentValue!==d.isSelected.previousValue&&(this.isSelected=d.isSelected.currentValue)}},{key:"toggleSort",value:function(){this.isAscending=!this.isAscending,this.onSort.emit(this.isAscending?1:-1)}}]),S}();return T.\u0275fac=function(x){return new(x||T)},T.\u0275cmp=f.Xpm({type:T,selectors:[["app-sort"]],inputs:{label:"label",isSelected:"isSelected",iconType:"iconType",order:"order",isBtnStyle:"isBtnStyle"},outputs:{onSort:"onSort"},features:[f.TTD],decls:2,vars:2,consts:[["class","sort-icon",3,"class","click",4,"ngIf"],[4,"ngIf"],[1,"sort-icon",3,"click"],["nbTooltip","Sort","aria-hidden","true",2,"margin-right","4px"],["size","medium","type","button","nbButton","","status","secondary",3,"click"],[1,"fa-regular","fa-arrow-down-arrow-up",2,"margin-right","10px"]],template:function(x,d){1&x&&(f.YNc(0,y,3,5,"span",0),f.YNc(1,I,4,0,"span",1)),2&x&&(f.Q6J("ngIf",!d.isBtnStyle),f.xp6(1),f.Q6J("ngIf",d.isBtnStyle))},directives:[h.O5,V.jNv,V.DPz],styles:['.sort-icon[_ngcontent-%COMP%] {\n  position: relative;\n  cursor: pointer;\n  font-weight: 600;\n  color: #bbbbbb;\n}\n.sort-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%] {\n  font-size: 15px;\n  color: #bbbbbb;\n}\n.sort-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover {\n  color: #6e689b !important;\n}\n.sort-selected[_ngcontent-%COMP%] {\n  color: #6e689b !important;\n}\n.sort-selected[_ngcontent-%COMP%]   i[_ngcontent-%COMP%] {\n  color: #6e689b !important;\n}\n@media (max-width: 380px) {\n  .sort-selected[_ngcontent-%COMP%] {\n    display: flex;\n  }\n}\n.status-secondary[_ngcontent-%COMP%] {\n  color: #344054;\n  border: 1px solid #D0D5DD !important;\n  font-weight: 700 !important;\n  font-family: "Inter" !important;\n  border-radius: 6px !important;\n  height: 35px !important;\n  margin-right: 10px;\n}']}),T}()}}]);